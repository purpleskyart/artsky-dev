import{j as e,u as t,z as n,af as a,D as s,k as r,Q as i,V as o,ag as l,ah as c,h as d,O as u,ai as h,l as m,ad as p,w as f,v as x,C as g,n as j,aj as b,r as v,p as y,q as w,ak as k,al as N,am as C,an as _,ao as S,ap as E,aq as L,ar as A,as as F,at as B,ae as $,au as P,aa as M}from"./index-UuWmRJH5.js";import{b as T,d as R,h as W,u as D,L as I,j as H}from"./react-vendor-DGaPsC2e.js";import{s as U,b as O,a as z,E as q,C as K,c as V,d as G}from"./Icons-BGFNIX80.js";import{P as Y}from"./PostText-BomDaunw.js";const Q=[{kind:"timeline",label:"Following"},{kind:"custom",label:"For You",uri:"at://did:plc:z72i7hdynmk6r22z27h6tvur/app.bsky.feed.generator/whats-hot"},{kind:"custom",label:"Popular With Friends",uri:"at://did:plc:z72i7hdynmk6r22z27h6tvur/app.bsky.feed.generator/with-friends"},{kind:"custom",label:"Art",uri:"at://did:plc:z72i7hdynmk6r22z27h6tvur/app.bsky.feed.generator/art"}],J=[{source:Q[0],percent:50},{source:Q[1],percent:50}],X=T.createContext(null);function Z(){return T.useContext(X)}function ee({feedSources:t,setSingleFeed:n,children:a}){return e.jsx(X.Provider,{value:{feedSources:t,setSingleFeed:n},children:a})}const te="_wrap_eb8da_1",ne="_compact_eb8da_6",ae="_searchRow_eb8da_6",se="_filterIconBtn_eb8da_11",re="_input_eb8da_17",ie="_searchSubmitBtn_eb8da_23",oe="_filterIconActive_eb8da_69",le="_searchRowFilterOpen_eb8da_114",ce="_filterDropdown_eb8da_119",de="_filterBtn_eb8da_134",ue="_filterActive_eb8da_135",he="_dropdown_eb8da_166",me="_suggestionsAbove_eb8da_182",pe="_item_eb8da_188",fe="_itemActive_eb8da_205",xe="_itemAvatar_eb8da_209",ge="_itemLabel_eb8da_217";function je(e){const t=e.match(/\/profile\/([^/?\s#]+)/i);if(t)try{return decodeURIComponent(t[1].trim())}catch{return t[1].trim()}const n=e.match(/profile=([^&\s]+)/i);if(!n)return null;try{return decodeURIComponent(n[1].trim())}catch{return n[1].trim()}}function be(e){const t=e.match(/[?&]post=(at%3A%2F%2F[^&\s]+)/i);if(t)try{const e=decodeURIComponent(t[1].trim());if(e.startsWith("at://"))return{type:"uri",uri:e}}catch{}if(/\/profile\//i.test(e)||/\/post\//i.test(e)){const t=e.match(/\/post\/(at%3A%2F%2F[^/?\s#]+)/i);if(t)try{const e=decodeURIComponent(t[1].trim());if(e.startsWith("at://"))return{type:"uri",uri:e}}catch{}const n=e.match(/\/profile\/([^/]+)\/post\/([^/?\s#]+)/i);if(n)try{const e=decodeURIComponent(n[1].trim()),t=n[2].trim();if(e&&t)return{type:"handleRkey",handle:e,rkey:t}}catch{}}return null}function ve(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:e.jsx("path",{d:"M4 6h16M4 12h10M4 18h6"})})}function ye(){return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.35-4.35"})]})}function we({onSelectFeed:r,inputRef:i,compact:o,onClose:l,suggestionsAbove:c}){const d=R(),{openProfileModal:u,openPostModal:h,openTagModal:m,openSearchModal:p}=t(),[f,x]=T.useState(""),[g,j]=T.useState("all"),[b,v]=T.useState(!1),[y,w]=T.useState(!1),[k,N]=T.useState([]),[C,_]=T.useState([]),[S,E]=T.useState(-1),[L,A]=T.useState(!1),[F,B]=T.useState(!1),$=T.useRef(null),P=T.useRef(null),M=i??P,W=f.trim(),D=W.startsWith("#"),I=D?W.slice(1).replace(/\s.*$/,"").toLowerCase():"",H=D&&I&&"feeds"!==g?{type:"tag",tag:I}:null,U=W?be(W):null,O=T.useCallback(async e=>{if(e&&!e.startsWith("#")&&"feeds"!==g){w(!0);try{const t=await n(e,8);N(t.actors??[])}catch{N([])}finally{w(!1)}}else N([])},[g]);T.useEffect(()=>{if(!W||W.startsWith("#")||"feeds"===g)return void N([]);const e=setTimeout(()=>O(W),200);return()=>clearTimeout(e)},[W,g,O]),T.useEffect(()=>{b&&("feeds"===g||"all"===g)&&W?a(6).then(e=>_(e??[])):_([])},[b,W,g]),T.useEffect(()=>{function e(e){$.current?.contains(e.target)||(v(!1),A(!1))}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const z=W?je(W):null,q=[];async function K(e){let t;if("uri"===e.type)t=e.uri;else{B(!0);try{t=`at://${(await s.getProfile({actor:e.handle})).data.did}/app.bsky.feed.post/${e.rkey}`}catch{return void u(e.handle)}finally{B(!1)}}h(t),x(""),v(!1),M.current?.blur(),l?.()}function V(e){const t=q[e];if(t)if(v(!1),x(""),"postFromUrl"===t.type)K(t.post);else if("profileFromUrl"===t.type)u(t.handle),M.current?.blur(),l?.();else if("tag"===t.type)m(t.tag),M.current?.blur(),l?.();else if("actor"===t.type)u(t.handle),M.current?.blur(),l?.();else if("feed"===t.type){const e=t.view,n={kind:"custom",label:e.displayName??e.uri,uri:e.uri};r?r(n):d("/feed",{state:{feedSource:n}}),M.current?.blur(),l?.()}}U&&"feeds"!==g?q.push({type:"postFromUrl",post:U}):z&&"feeds"!==g&&q.push({type:"profileFromUrl",handle:z}),H&&q.push(H),"feeds"!==g&&k.forEach(e=>q.push({type:"actor",handle:e.handle,did:e.did,avatar:e.avatar,displayName:e.displayName})),"feeds"!==g&&"all"!==g||W||!C.length||C.forEach(e=>q.push({type:"feed",view:e})),T.useEffect(()=>{E(-1)},[f,k.length,C.length,H,z,U]);const G="users"===g?"Search users, #hashtags…":"feeds"===g?"Browse feeds…":"Search users, feeds, #hashtags…",Y=W.length>0&&!/\s/.test(W)&&(W.startsWith("@")||W.includes("."));function Q(){const e=be(W);if(e)return void K(e);const t=je(W);return t?(u(t),x(""),v(!1),M.current?.blur(),void l?.()):Y?(u(W.replace(/^@/,"")),x(""),v(!1),M.current?.blur(),void l?.()):W.length>0?(p(W),x(""),v(!1),M.current?.blur(),void l?.()):void(b&&q.length>0&&S>=0&&V(S))}return e.jsxs("div",{className:`${te} ${o?ne:""} ${c?me:""}`,ref:$,children:[e.jsxs("div",{className:`${ae} ${L?le:""}`,children:[e.jsx("button",{type:"button",className:`${se} ${L?oe:""}`,onClick:()=>A(e=>!e),"aria-label":"Search filter","aria-expanded":L,children:e.jsx(ve,{})}),e.jsx("input",{ref:e=>{P.current=e,i&&(i.current=e)},type:"search",placeholder:G,value:f,onChange:e=>{x(e.target.value),v(!0)},onFocus:()=>v(!0),onKeyDown:function(e){if("Escape"===e.key)return v(!1),void l?.();if("Enter"===e.key||"e"===e.key&&(e.ctrlKey||e.metaKey))return b&&q.length>0&&S>=0?(e.preventDefault(),void V(S)):(e.preventDefault(),void Q());b&&0!==q.length&&("ArrowDown"===e.key?(e.preventDefault(),E(e=>e<0?0:(e+1)%q.length)):"ArrowUp"===e.key&&(e.preventDefault(),E(e=>e<=0?q.length-1:e-1)))},className:re,"aria-label":"Search","aria-autocomplete":"list","aria-expanded":b&&q.length>0}),e.jsx("button",{type:"button",className:ie,onClick:Q,disabled:F,"aria-label":"Search",children:e.jsx(ye,{})}),L&&e.jsx("div",{className:ce,children:["all","users","feeds"].map(t=>e.jsx("button",{type:"button",className:g===t?ue:de,onClick:()=>{j(t),A(!1)},children:"all"===t?"All":"users"===t?"Users":"Feeds"},t))})]}),b&&(q.length>0||y)&&e.jsxs("div",{className:he,role:"listbox",children:[y&&0===q.length&&e.jsx("div",{className:pe,children:"Searching…"}),q.map((t,n)=>{if("postFromUrl"===t.type)return e.jsx("button",{type:"button",role:"option",className:`${pe} ${n===S?fe:""}`,onClick:()=>V(n),disabled:F,children:e.jsx("span",{className:ge,children:F?"Opening post…":"Open post"})},"post-from-url");if("profileFromUrl"===t.type)return e.jsx("button",{type:"button",role:"option",className:`${pe} ${n===S?fe:""}`,onClick:()=>V(n),children:e.jsxs("span",{className:ge,children:["Open profile @",t.handle]})},`profile-${t.handle}`);if("tag"===t.type)return e.jsx("button",{type:"button",role:"option",className:`${pe} ${n===S?fe:""}`,onClick:()=>V(n),children:e.jsxs("span",{className:ge,children:["Browse #",t.tag]})},`tag-${t.tag}`);if("actor"===t.type)return e.jsxs("button",{type:"button",role:"option",className:`${pe} ${n===S?fe:""}`,onClick:()=>V(n),children:[t.avatar&&e.jsx("img",{src:t.avatar,alt:"",className:xe,loading:"lazy"}),e.jsxs("span",{className:ge,children:[t.displayName?`${t.displayName} `:"","@",t.handle]})]},t.did);if("feed"===t.type){const a=t.view;return e.jsxs("button",{type:"button",role:"option",className:`${pe} ${n===S?fe:""}`,onClick:()=>V(n),children:[a.avatar&&e.jsx("img",{src:a.avatar,alt:"",className:xe,loading:"lazy"}),e.jsx("span",{className:ge,children:a.displayName??a.uri})]},a.uri)}return null})]})]})}function ke(){const e=[];let t=0;try{for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(a?.startsWith("artsky-")){e.push(a);const n=localStorage.getItem(a)??"";t+=2*(a.length+n.length)}}}catch{}return{totalBytes:t,keys:e}}async function Ne(){const{totalBytes:e}=ke(),t=await async function(){const e=[];try{if(!("caches"in self))return e;const t=await caches.keys();for(const n of t){const t=await caches.open(n),a=await t.keys();let s=0;for(const e of a)try{const n=await t.match(e);n?.body&&(s+=(await n.blob()).size)}catch{s+=1024}e.push({name:n,bytes:s,entries:a.length})}}catch{}return e}();return{localStorageBytes:e,cacheBytes:t.reduce((e,t)=>e+t.bytes,0),cacheBreakdown:t}}function Ce(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(1)} ${["B","KB","MB"][t]}`}function _e({onClose:t,showToast:n,onLocalDataCleared:a}){const[s,r]=T.useState(!0),[i,o]=T.useState(null),[l,c]=T.useState(null),[d,u]=T.useState(!1),[h,m]=T.useState(!1),p=T.useCallback(async()=>{r(!0);try{const e=await Ne();o(e)}catch{o({localStorageBytes:0,cacheBytes:0,cacheBreakdown:[]})}finally{r(!1)}},[]);T.useEffect(()=>{p()},[p]);const f=i?i.localStorageBytes+i.cacheBytes:0,x=i?.cacheBreakdown.find(e=>"artsky-images"===e.name);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:U.searchOverlayBackdrop,onClick:t,"aria-hidden":!0}),e.jsx("div",{className:U.settingsOverlay,role:"dialog","aria-label":"Storage & Cache",onClick:t,children:e.jsxs("div",{className:U.settingsCard,onClick:e=>e.stopPropagation(),children:[e.jsx("h2",{className:U.settingsTitle,children:"Storage & Cache"}),e.jsxs("section",{className:U.settingsSection,children:[e.jsx("h3",{className:U.settingsSubtitle,children:"Storage usage"}),s?e.jsx("p",{className:U.settingsMuted,children:"Loading…"}):i?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:U.settingsUsage,children:[e.jsx("strong",{children:"Total:"})," ",Ce(f)]}),e.jsxs("ul",{className:U.settingsBreakdown,children:[e.jsxs("li",{children:["App data (settings, artboards, sessions):"," ",Ce(i.localStorageBytes)]}),i.cacheBreakdown.map(t=>e.jsxs("li",{children:["artsky-images"===t.name?"Image cache":t.name,":"," ",Ce(t.bytes)," (",t.entries," items)"]},t.name)),0===i.cacheBreakdown.length&&e.jsx("li",{className:U.settingsMuted,children:"No cache data"})]})]}):null]}),e.jsxs("section",{className:U.settingsSection,children:[e.jsx("h3",{className:U.settingsSubtitle,children:"Actions"}),e.jsxs("div",{className:U.settingsActions,children:[e.jsx("button",{type:"button",className:U.settingsActionBtn,onClick:async()=>{c("image");try{await async function(){try{"caches"in self&&await caches.delete("artsky-images")}catch{}}(),await p(),n("Image cache cleared")}catch{n("Could not clear image cache")}finally{c(null)}},disabled:null!==l||!x?.bytes,title:"Clear cached Bluesky images",children:"image"===l?"Clearing…":"Clear image cache"}),e.jsx("button",{type:"button",className:`${U.settingsActionBtn} ${U.settingsActionBtnDanger}`,onClick:async()=>{if(h){c("local");try{!function(){const{keys:e}=ke();for(const t of e)try{localStorage.removeItem(t)}catch{}}(),n("Local data cleared"),a?.(),t(),window.location.reload()}catch{n("Could not clear local data")}finally{c(null)}}else m(!0)},disabled:null!==l,title:"Clear all local data including artboards, drafts, and sessions. You will be logged out.",children:"local"===l?"Clearing…":h?"Yes, clear everything":"Clear local data"}),h&&e.jsx("button",{type:"button",className:U.settingsActionBtn,onClick:()=>m(!1),children:"Cancel"})]})]}),e.jsxs("section",{className:U.settingsSection,children:[e.jsx("h3",{className:U.settingsSubtitle,children:"App updates"}),e.jsx("button",{type:"button",className:U.settingsActionBtn,onClick:async()=>{u(!0);try{const e=await(navigator.serviceWorker?.getRegistration());if(!e)return void n("Service worker not active");await e.update(),e.waiting?n("Update available. Refresh to apply."):n("You're up to date")}catch{n("Could not check for updates")}finally{u(!1)}},disabled:d||!("serviceWorker"in navigator),title:"Check for a new version of ArtSky",children:d?"Checking…":"Check for updates"})]}),e.jsx("button",{type:"button",className:U.aboutClose,onClick:t,"aria-label":"Close",children:"Close"})]})})]})}const Se="_wrap_996id_1",Ee="_wrapDropdown_996id_6",Le="_feedRow_996id_11",Ae="_tabs_996id_20",Fe="_feedRowAdd_996id_28",Be="_addFeedPage_996id_34",$e="_helpBtn_996id_42",Pe="_header_996id_49",Me="_headerTitle_996id_59",Te="_headerActions_996id_66",Re="_editFeedsBtn_996id_73",We="_editFeedsDoneBtn_996id_74",De="_editFeedsSection_996id_90",Ie="_editFeedsBtnPage_996id_94",He="_editFeedsList_996id_114",Ue="_editFeedsItem_996id_120",Oe="_editFeedsOrderBtns_996id_129",ze="_editFeedsOrderBtn_996id_129",qe="_editFeedsRemovePlaceholder_996id_164",Ke="_editFeedsLabel_996id_173",Ve="_editFeedsRemoveBtn_996id_183",Ge="_helpWrap_996id_199",Ye="_helpModalOverlay_996id_246",Qe="_helpModalCard_996id_258",Je="_helpModalIntro_996id_285",Xe="_helpModalSubtitle_996id_293",Ze="_helpModalShortcuts_996id_303",et="_helpModalClose_996id_324",tt="_feedContextMenu_996id_345",nt="_feedContextMenuItem_996id_356",at="_section_996id_374",st="_sectionAdd_996id_391",rt="_customForm_996id_395",it="_addFeed_996id_34",ot="_sectionHint_996id_403",lt="_ratioHint_996id_410",ct="_feedPillWrap_996id_431",dt="_wrapTouchFriendly_996id_448",ut="_feedPillRow_996id_463",ht="_ratioBtnSide_996id_463",mt="_feedPillWithFill_996id_470",pt="_feedPillRemoveBtn_996id_551",ft="_feedPillColumn_996id_584",xt="_ratioBtnRow_996id_591",gt="_feedPillLabel_996id_650",jt="_feedPillRatio_996id_651",bt="_feedPillInactive_996id_661",vt="_customInputWrap_996id_744",yt="_input_996id_748",wt="_customSuggestionsWrap_996id_758",kt="_customSuggestionsSection_996id_777",Nt="_customSuggestionsLoading_996id_786",Ct="_customSuggestions_996id_758",_t="_customSuggestionItem_996id_804",St="_customActions_996id_820",Et="_btn_996id_825",Lt="_btnSecondary_996id_840";function At(e){if("undefined"==typeof window)return()=>{};const t=window.matchMedia("(min-width: 768px)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}function Ft(){return"undefined"!=typeof window&&window.innerWidth>=768}function Bt(e,t){return(e.uri??e.label)===(t.uri??t.label)}function $t({sources:t,fallbackSource:n,mixEntries:s,onToggle:o,setEntryPercent:l,onAddCustom:c,onToggleWhenGuest:d,variant:u="page",touchFriendly:h=!1,removableSourceUris:m,onRemoveFeed:p,onShareFeed:f,onReorderSources:x}){const{session:g}=r(),[j,b]=T.useState(""),[v,y]=T.useState(!1),[w,k]=T.useState(!1),[N,C]=T.useState(!1),[_,S]=T.useState([]),[E,L]=T.useState(!1),[A,F]=T.useState(""),[B,$]=T.useState(null),[P,M]=T.useState(!1),R=T.useRef(null),D=T.useRef(null),I=T.useRef(null),H=T.useRef(null),U=T.useSyncExternalStore(At,Ft,()=>!1),O=j.trim().toLowerCase(),z=O?O.split(/\s+/).filter(Boolean):[],q=(z.length>0?t.filter(e=>{const t=(e.label??"").toLowerCase(),n=(e.uri??"").toLowerCase();return z.every(e=>t.includes(e)||n.includes(e))}):[]).slice(0,10);T.useEffect(()=>{if(!v)return S([]),void F("");const e=j.trim();return H.current&&(clearTimeout(H.current),H.current=null),H.current=setTimeout(()=>{if(H.current=null,""===e)return void(g?(F("Suggested feeds"),L(!0),a(10).then(e=>{S((e??[]).map(e=>({kind:"custom",label:e.displayName??e.uri??"",uri:e.uri})))}).catch(()=>S([])).finally(()=>L(!1))):S([]));if(/^@?[a-zA-Z0-9.-]+$/.test(e)&&e.length>=2){const t=e.replace(/^@/,"");F(`Feeds by @${t}`),L(!0),i(t,20).then(e=>{S(e.map(e=>({kind:"custom",label:e.displayName??e.uri,uri:e.uri})))}).catch(()=>S([])).finally(()=>L(!1))}else S([]),F("")},350),()=>{H.current&&clearTimeout(H.current)}},[v,j,g]),T.useEffect(()=>{if(N)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e);function e(e){R.current&&!R.current.contains(e.target)&&C(!1)}},[N]),T.useEffect(()=>{if(B)return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)};function e(e){const t=e.target;D.current?.contains(t)||$(null)}},[B]);const K=s.length>=2,V="dropdown"===u,G=(t.filter(e=>e.uri&&m?.has(e.uri)).length>0||t.length>0&&x)&&(p||x);T.useEffect(()=>{P&&0===t.length&&M(!1)},[P,t.length]),T.useEffect(()=>{if(!N||V)return;const e=e=>{"Escape"===e.key&&(e.preventDefault(),C(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[N,V]);const Y=e.jsx("div",{className:Ge,ref:R,children:e.jsx("button",{type:"button",className:$e,onClick:()=>C(e=>!e),"aria-label":"Explain remix feed and shortcuts","aria-expanded":N,title:"How mixing works",children:"?"})}),Q=N?W.createPortal(e.jsx("div",{className:Ye,onClick:()=>C(!1),role:"dialog","aria-label":"Feed mix and shortcuts",children:e.jsxs("div",{className:Qe,onClick:e=>e.stopPropagation(),children:[e.jsx("p",{className:Je,children:"Use + or - to change how many posts you see from each feed."}),U&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:Xe,children:"Keyboard shortcuts"}),e.jsxs("dl",{className:Ze,children:[e.jsx("dt",{children:"W / ↑"}),e.jsx("dd",{children:"Move up"}),e.jsx("dt",{children:"A / ←"}),e.jsx("dd",{children:"Move left"}),e.jsx("dt",{children:"S / ↓"}),e.jsx("dd",{children:"Move down"}),e.jsx("dt",{children:"D / →"}),e.jsx("dd",{children:"Move right"}),e.jsx("dt",{children:"Q"}),e.jsx("dd",{children:"Quit / close window"}),e.jsx("dt",{children:"E"}),e.jsx("dd",{children:"Enter post"}),e.jsx("dt",{children:"R"}),e.jsx("dd",{children:"Reply to post"}),e.jsx("dt",{children:"T"}),e.jsx("dd",{children:"Toggle text view"}),e.jsx("dt",{children:"F"}),e.jsx("dd",{children:"Like / unlike"}),e.jsx("dt",{children:"C"}),e.jsx("dd",{children:"Collect post"}),e.jsx("dt",{children:"B"}),e.jsx("dd",{children:"Block author (feed)"}),e.jsx("dt",{children:"4"}),e.jsx("dd",{children:"Follow author"}),e.jsx("dt",{children:"Escape"}),e.jsx("dd",{children:"Escape all windows"}),e.jsx("dt",{children:"1 / 2 / 3"}),e.jsx("dd",{children:"1, 2, or 3 column view"})]})]}),e.jsx("button",{type:"button",className:et,onClick:()=>C(!1),"aria-label":"Close",children:"Close"})]})}),document.body):null,J=e.jsx(e.Fragment,{children:t.map(t=>{const a=s.findIndex(e=>Bt(e.source,t)),r=a>=0||0===s.length&&Bt(t,n),i=r?s[a]:null,c=r&&s.length>=2&&i,u=c&&(i?.percent??0)>=5,h=c&&(i?.percent??0)<100,x=!r,g=i?.percent??0,j=e.jsxs("button",{type:"button",className:`${mt} ${r?"":bt}`,style:r&&i?g>=100?{background:"var(--accent)"}:{backgroundColor:"var(--surface)",backgroundImage:`linear-gradient(to right, var(--accent) 0%, var(--accent) ${g}%, transparent ${g}%)`}:void 0,onClick:()=>d?d():o(t),children:[e.jsx("span",{className:gt,children:t.label}),e.jsx("span",{className:jt,children:r&&i?`${g}% of posts`:"0% of posts"})]}),b=e.jsx("button",{type:"button",className:ht,disabled:!u,onClick:e=>{e.stopPropagation(),d?d():u&&l(a,Math.max(0,(i?.percent??0)-5))},"aria-label":"Fewer posts from this feed",children:"−"}),v=e.jsx("button",{type:"button",className:ht,disabled:!h&&!x,onClick:e=>{e.stopPropagation(),d?d():x?o(t):h&&l(a,Math.min(100,(i?.percent??0)+5))},"aria-label":x?"Add feed to mix":"More posts from this feed",children:"+"}),y=f||p&&t.uri&&m?.has(t.uri),w=!(!t.uri||!m?.has(t.uri)),k=(e,n)=>{y&&$({source:t,x:e,y:n})};return e.jsxs("div",{className:ct,onContextMenu:e=>{y&&(e.preventDefault(),k(e.clientX,e.clientY))},onTouchStart:e=>{if(!y||0===e.changedTouches.length)return;const t=e.changedTouches[0];I.current=setTimeout(()=>{I.current=null,k(t.clientX,t.clientY)},500)},onTouchEnd:()=>{I.current&&(clearTimeout(I.current),I.current=null)},onTouchMove:()=>{I.current&&(clearTimeout(I.current),I.current=null)},children:[!V&&P&&w&&p&&e.jsx("button",{type:"button",className:pt,onClick:e=>{e.stopPropagation(),p(t)},"aria-label":`Remove ${t.label} from pinned feeds`,title:"Remove from pinned feeds",children:"×"}),V?e.jsxs("div",{className:ut,children:[b,j,v]}):e.jsxs("div",{className:ft,children:[j,e.jsxs("div",{className:xt,children:[b,v]})]})]},t.uri??t.label)})}),X=q.length>0||_.length>0||E,Z=v?e.jsxs("form",{onSubmit:async function(e){e.preventDefault();const t=j.trim();if(!t)return;if(/^(https?:\/\/|at:\/\/)/i.test(t)||t.includes("bsky.app")){k(!0);try{await c(t),y(!1),b("")}finally{k(!1)}}else{if(1===q.length)return o(q[0]),y(!1),void b("");if(1!==_.length){k(!0);try{await c(t),y(!1),b("")}finally{k(!1)}}else{k(!0);try{await c(_[0]),y(!1),b("")}finally{k(!1)}}}},className:rt,children:[e.jsxs("div",{className:vt,children:[e.jsx("input",{type:"text",placeholder:"Paste feed URL, or type a handle to find their feeds…",value:j,onChange:e=>b(e.target.value),className:yt,disabled:w,autoComplete:"off","aria-autocomplete":"list","aria-controls":X?"feed-search-suggestions":void 0,"aria-expanded":X}),(q.length>0||_.length>0||E)&&e.jsxs("div",{id:"feed-search-suggestions",className:wt,"aria-label":"Feeds",children:[q.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:kt,children:"Your feeds"}),e.jsx("ul",{className:Ct,role:"listbox","aria-label":"Your feeds",children:q.map(t=>e.jsx("li",{role:"option",children:e.jsx("button",{type:"button",className:_t,onClick:()=>(o(t),b(""),void y(!1)),children:t.label})},t.uri??t.label))})]}),E&&0===_.length&&e.jsx("div",{className:Nt,children:"Searching…"}),_.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:kt,children:A}),e.jsx("ul",{className:Ct,role:"listbox","aria-label":A,children:_.map(t=>e.jsx("li",{role:"option",children:e.jsx("button",{type:"button",className:_t,onClick:()=>async function(e){if(e.uri)if(d)d();else{k(!0);try{await c(e),y(!1),b("")}finally{k(!1)}}}(t),disabled:w,children:t.label})},t.uri??t.label))})]})]})]}),e.jsxs("div",{className:St,children:[e.jsx("button",{type:"submit",className:Et,disabled:w,children:w?"Adding…":"Add"}),e.jsx("button",{type:"button",className:Lt,onClick:()=>y(!1),disabled:w,children:"Cancel"})]})]}):e.jsx("button",{type:"button",className:V?it:Be,onClick:()=>d?d():y(!0),children:"+ Add Custom Feed"}),ee=B&&(f||p)?e.jsxs("div",{ref:D,className:tt,style:{left:B.x+4,top:B.y+4},role:"menu",children:[p&&B.source.uri&&m?.has(B.source.uri)&&e.jsx("button",{type:"button",className:nt,role:"menuitem",onClick:()=>{p(B.source),$(null)},children:"Delete"}),f&&e.jsx("button",{type:"button",className:nt,role:"menuitem",onClick:()=>{f(B.source),$(null)},children:"Copy link"})]}):null;return V?e.jsxs("div",{className:`${Se} ${Ee} ${h?dt:""}`,children:[ee,Q,e.jsxs("header",{className:Pe,children:[e.jsx("span",{className:Me,children:P?"Edit feeds":"Feeds"}),e.jsxs("div",{className:Te,children:[P?e.jsx("button",{type:"button",className:We,onClick:()=>M(!1),children:"Done"}):G?e.jsx("button",{type:"button",className:Re,onClick:()=>M(!0),children:"Edit"}):null,Y]})]}),P?e.jsxs("section",{className:De,"aria-label":"Edit feeds",children:[e.jsx("p",{className:ot,children:"Use ↑ ↓ to change order. Tap Remove to delete a feed from your list."}),e.jsx("ul",{className:He,children:t.map((n,a)=>{const s=x&&a>0,r=x&&a<t.length-1,i=n.uri&&m?.has(n.uri);return e.jsxs("li",{className:Ue,children:[e.jsxs("div",{className:Oe,children:[e.jsx("button",{type:"button",className:ze,onClick:()=>{if(!s||!x)return;const e=[...t];[e[a-1],e[a]]=[e[a],e[a-1]],x(e)},disabled:!s,"aria-label":`Move ${n.label} up`,title:"Move up",children:"↑"}),e.jsx("button",{type:"button",className:ze,onClick:()=>{if(!r||!x)return;const e=[...t];[e[a],e[a+1]]=[e[a+1],e[a]],x(e)},disabled:!r,"aria-label":`Move ${n.label} down`,title:"Move down",children:"↓"})]}),e.jsx("span",{className:Ke,children:n.label}),i?e.jsx("button",{type:"button",className:Ve,onClick:()=>p?.(n),"aria-label":`Remove ${n.label}`,children:"Remove"}):e.jsx("span",{className:qe,"aria-hidden":!0})]},n.uri??n.label??a)})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:at,"aria-label":"Choose feeds",children:[e.jsx("p",{className:ot,children:"Tap a feed to add or remove it from your mix."}),e.jsx("div",{className:Ae,children:J}),K&&e.jsx("p",{className:lt,children:"Use − and + on each side of a feed to set how many posts you see from it."})]}),e.jsx("section",{className:st,children:Z})]})]}):e.jsxs("div",{className:Se,children:[ee,Q,e.jsx("div",{className:Le,children:e.jsxs("div",{className:Ae,children:[J,G?e.jsx("button",{type:"button",className:Ie,onClick:()=>M(e=>!e),children:P?"Done":"Edit"}):null,Y]})}),e.jsx("div",{className:Fe,children:Z})]})}const Pt="_wrap_1sgom_1",Mt="_mirror_1sgom_7",Tt="_textarea_1sgom_24",Rt="_dropdown_1sgom_43",Wt="_loading_1sgom_60",Dt="_list_1sgom_66",It="_item_1sgom_74",Ht="_itemActive_1sgom_75",Ut="_avatar_1sgom_98",Ot="_avatarPlaceholder_1sgom_106",zt="_itemMain_1sgom_120",qt="_handle_1sgom_127",Kt="_tag_1sgom_128",Vt="_forumTitle_1sgom_132",Gt="_meta_1sgom_139",Yt=["@","#","%"];function Qt({value:t,onChange:a,onKeyDown:s,placeholder:r,rows:i=3,maxLength:d,disabled:u,autoFocus:h,className:m,id:p,"aria-label":f,inputRef:x}){const g=T.useRef(null),j=x??g,b=T.useRef(null),v=T.useRef(null),y=T.useRef(null),w=T.useRef(null),k=T.useRef(null),[N,C]=T.useState([]),[_,S]=T.useState(!1),[E,L]=T.useState(0),[A,F]=T.useState(!1),[B,$]=T.useState(0),[P,M]=T.useState(null),R=T.useRef(null),D=T.useRef(null),I=280,H=T.useMemo(()=>function(e,t){const n=e.slice(0,t);for(const a of Yt){const e=n.lastIndexOf(a);if(-1===e)continue;const t=0===e?" ":n[e-1];if(" "!==t&&"\n"!==t)continue;const s=n.slice(e+1);if(!("@"===a&&/[\s\n]/.test(s)||"#"===a&&/[\s\n]/.test(s)))return{trigger:a,query:s,startIndex:e}}return null}(t,B),[t,B]),U=T.useCallback(()=>{const e=j.current;e&&$(e.selectionStart)},[j]),O=T.useCallback(async(e,t)=>{if("@"===e){const e=t.trim();if(!e)return void C([]);S(!0);try{const{actors:t}=await n(e,8);C((t??[]).map(e=>({type:"user",handle:e.handle??e.did,displayName:e.displayName,avatar:e.avatar})))}catch{C([])}finally{S(!1)}return}if("#"===e){const e=t.trim().toLowerCase().replace(/\s+/g,"-");if(!e)return void C([]);S(!0);try{const{posts:t}=await o(e,void 0);C([{type:"tag",tag:e,count:t?.length??0}])}catch{C([{type:"tag",tag:e}])}finally{S(!1)}return}if("%"===e){S(!0);try{const e=await l(t,8);C(e.map(e=>({type:"forum",doc:e})))}catch{C([])}finally{S(!1)}}},[]);T.useEffect(()=>{if(!H)return R.current=null,F(!1),void C([]);R.current=H;const{trigger:e,query:t}=H;return D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{D.current=null,O(e,t).then(()=>{L(0),F(!0)})},200),()=>{D.current&&clearTimeout(D.current)}},[H,O]);const z=T.useCallback(e=>{const n=R.current;if(!n||!j.current)return;const s=n.startIndex,r=s+1+n.query.length;let i;i="user"===e.type?`@${e.handle}`:"tag"===e.type?`#${e.tag}`:c(e.doc);const o=t.slice(0,s),l=t.slice(r),u=o+i+l;a(null!=d?u.slice(0,d):u),F(!1),C([]),requestAnimationFrame(()=>{j.current?.focus();const e=s+i.length;j.current?.setSelectionRange(e,e)})},[t,a,d,j]),q=T.useCallback(e=>{if(A&&N.length>0){if("ArrowDown"===e.key)return e.preventDefault(),void L(e=>(e+1)%N.length);if("ArrowUp"===e.key)return e.preventDefault(),void L(e=>(e-1+N.length)%N.length);if("Enter"===e.key||"Tab"===e.key)return e.preventDefault(),void z(N[E]);if("Escape"===e.key)return e.preventDefault(),F(!1),void C([])}s?.(e)},[A,N,E,z,s]),K=T.useCallback(e=>{const t=e.target.value;a(null!=d?t.slice(0,d):t),$(e.target.selectionStart)},[a,d]),V=T.useCallback(()=>{U()},[U]),G=T.useCallback(()=>{F(!1),C([])},[]);T.useEffect(()=>{if(!A||!v.current)return;const e=v.current.children[E];e?.scrollIntoView({block:"nearest",behavior:"smooth"})},[E,A]);const Y=H?.startIndex??-1,Q=A&&Y>=0&&(N.length>0||_);T.useLayoutEffect(()=>{if(!Q||!w.current||!j.current)return void M(null);const e=w.current.getBoundingClientRect(),t=("undefined"!=typeof window?window.innerHeight-e.bottom:400)<288&&e.top>288;M({left:e.left,...t?{bottom:"undefined"!=typeof window?window.innerHeight-e.top+4:void 0}:{top:e.bottom+4},above:t})},[Q,t,Y,N.length,_]),T.useEffect(()=>{A||M(null)},[A]);const J=T.useCallback(()=>{if(!Q||!w.current)return;const e=w.current.getBoundingClientRect(),t=("undefined"!=typeof window?window.innerHeight-e.bottom:400)<288&&e.top>288;M({left:e.left,...t?{bottom:"undefined"!=typeof window?window.innerHeight-e.top+4:void 0}:{top:e.bottom+4},above:t})},[Q]);return T.useEffect(()=>{if(!Q)return;const e=j.current;if(!e)return;const t=()=>J(),n=e.ownerDocument?.defaultView;return n?.addEventListener("scroll",t,!0),n?.addEventListener("resize",J),()=>{n?.removeEventListener("scroll",t,!0),n?.removeEventListener("resize",J)}},[Q,J]),e.jsxs("div",{ref:b,className:Pt,children:[Q&&e.jsxs("div",{ref:y,className:Mt,"aria-hidden":!0,children:[t.slice(0,Y),e.jsx("span",{ref:w})]}),e.jsx("textarea",{ref:j,id:p,className:m??Tt,value:t,onChange:K,onSelect:V,onBlur:G,onKeyUp:U,onKeyDown:q,placeholder:r,rows:i,maxLength:d,disabled:u,autoFocus:h,"aria-label":f}),A&&(N.length>0||_)&&(()=>{const t=e.jsx("div",{ref:k,className:Rt,role:"listbox","aria-label":"Suggestions",style:P?{position:"fixed",left:P.left,...P.above?{bottom:P.bottom,top:"auto"}:{top:P.top},right:"auto",width:"max(200px, min(320px, 90vw))",maxHeight:I}:void 0,children:_&&0===N.length?e.jsx("div",{className:Wt,children:"Searching…"}):e.jsx("ul",{ref:v,className:Dt,children:N.map((t,n)=>e.jsxs("li",{className:n===E?Ht:It,role:"option","aria-selected":n===E,onMouseDown:e=>{e.preventDefault(),z(t)},children:["user"===t.type&&e.jsxs(e.Fragment,{children:[t.avatar?e.jsx("img",{src:t.avatar,alt:"",className:Ut}):e.jsx("span",{className:Ot,children:(t.displayName??t.handle).slice(0,1).toUpperCase()}),e.jsxs("span",{className:zt,children:[e.jsxs("span",{className:qt,children:["@",t.handle]}),t.displayName&&e.jsx("span",{className:Gt,children:t.displayName})]})]}),"tag"===t.type&&e.jsxs("span",{className:zt,children:[e.jsxs("span",{className:Kt,children:["#",t.tag]}),null!=t.count&&t.count>0&&e.jsxs("span",{className:Gt,children:[t.count," posts"]})]}),"forum"===t.type&&e.jsxs("span",{className:zt,children:[e.jsx("span",{className:Vt,children:t.doc.title??t.doc.path??t.doc.uri}),t.doc.authorHandle&&e.jsxs("span",{className:Gt,children:["@",t.doc.authorHandle]})]})]},"user"===t.type?t.handle:"tag"===t.type?t.tag:t.doc.uri))})});return P&&"undefined"!=typeof document?W.createPortal(t,document.body):t})()]})}const Jt="_wrap_11h49_1",Xt="_count_11h49_7",Zt="_circle_11h49_14",en="_circleBg_11h49_20",tn="_circleBar_11h49_25",nn=10,an=2*Math.PI*nn;function sn({used:t,max:n,className:a}){const s=Math.max(0,n-t),r=an*(1-(n>0?t/n:0));return e.jsxs("div",{className:`${Jt} ${a??""}`,"aria-live":"polite","data-low":s>0&&s<=20?"true":void 0,"data-zero":0===s?"true":void 0,children:[e.jsx("span",{className:Xt,children:s}),e.jsxs("svg",{className:Zt,viewBox:"0 0 24 24","aria-hidden":!0,children:[e.jsx("circle",{className:en,cx:12,cy:12,r:nn,fill:"none"}),e.jsx("circle",{className:tn,cx:12,cy:12,r:nn,fill:"none",strokeDasharray:an,strokeDashoffset:r,strokeLinecap:"round",transform:"rotate(-90 12 12)"})]})]})}const rn=[{kind:"timeline",label:"Following"},{kind:"custom",label:"What's Hot",uri:"at://did:plc:z72i7hdynmk6r22z27h6tvur/app.bsky.feed.generator/whats-hot"}],on="artsky-hidden-preset-feeds",ln="artsky-feed-order";function cn(e){return e.uri??("timeline"===e.kind?"timeline":e.label??"")}function dn(){try{const e=localStorage.getItem(on);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t):new Set}catch{return new Set}}function un(){try{const e=localStorage.getItem(ln);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch{return[]}}const hn=H.createContext({wrapperRef:null,setHandlers:null});function mn({active:t}){const n=t?2.5:2;return e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:n,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function pn(){return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})}function fn(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}function xn({active:t}){const n=t?2.5:2;return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:n,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.35-4.35"})]})}function gn(){return e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:e.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}function jn(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),e.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),e.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]})}function bn(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}function vn(){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),e.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]})}function yn({mode:t}){return"open"===t?e.jsx(O,{size:24}):"half"===t?e.jsx(z,{size:24}):e.jsx(q,{size:24})}function wn({mode:t}){return"default"===t?e.jsx(K,{size:20}):"minimalist"===t?e.jsx(V,{size:20}):e.jsx(G,{size:20})}function kn(){return e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:e.jsx("rect",{x:"7",y:"3",width:"10",height:"18",rx:"1"})})}function Nn(){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("rect",{x:"3",y:"3",width:"8",height:"18",rx:"1"}),e.jsx("rect",{x:"13",y:"3",width:"8",height:"18",rx:"1"})]})}function Cn(){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("rect",{x:"2",y:"3",width:"5",height:"18",rx:"1"}),e.jsx("rect",{x:"9.5",y:"3",width:"5",height:"18",rx:"1"}),e.jsx("rect",{x:"17",y:"3",width:"5",height:"18",rx:"1"})]})}function _n(){return e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:e.jsx("path",{d:"M12 5v14M5 12h14"})})}function Sn(){return e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})}function En(){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),e.jsx("polyline",{points:"10 17 15 12 10 7"}),e.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]})}function Ln(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("circle",{cx:"12",cy:"12",r:"4"}),e.jsx("path",{d:"M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"})]})}function An(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}function Fn(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("circle",{cx:"12",cy:"12",r:"9"}),e.jsx("path",{d:"M12 3v18"}),e.jsx("path",{d:"M6 12a6 6 0 0 1 6-6 6 6 0 0 1 6 6"}),e.jsx("circle",{cx:"16.5",cy:"12",r:"2"})]})}function Bn(){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}function $n(){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4M12 8h.01"})]})}function Pn(){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),e.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),e.jsx("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"}),e.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"})]})}function Mn(){return e.jsx("span",{className:U.mediaModeIconWrap,children:e.jsxs("svg",{viewBox:"0 0 20 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:[e.jsx("path",{d:"M10 2v6M5.5 2h9"}),e.jsx("rect",{x:"4",y:"12",width:"12",height:"10",rx:"1"}),e.jsx("circle",{cx:"7.5",cy:"15",r:"1"}),e.jsx("path",{d:"M14.5 21l-2.5-2-4 3"})]})})}function Tn(){return"undefined"!=typeof window&&window.innerWidth>=768}function Rn(e){if("undefined"==typeof window)return()=>{};const t=window.matchMedia("(min-width: 768px)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}function Wn({title:n,children:a,showNav:i}){const o=D(),l=R(),{openProfileModal:c,openPostModal:H,isModalOpen:O,modalScrollHidden:z,openForumModal:q,openArtboardsModal:K,closeAllModals:V}=t(),G=o.search,X=/\bforum=1\b/.test(G),Z=/\bartboards=1\b/.test(G)||/\bartboard=/.test(G),{openLoginModal:te}=d(),ne=u(),{session:ae,sessionsList:se,logout:re,switchAccount:ie}=r(),[oe,le]=T.useState({}),[ce,de]=T.useState(0),ue=T.useMemo(()=>se.map(e=>e.did).sort().join(","),[se]),he=ae?oe[ae.did]?.avatar:null;T.useEffect(()=>{ne?.registerOnSaved(()=>de(e=>e+1))},[ne?.registerOnSaved]),T.useEffect(()=>{if(0===se.length)return void le({});let e=!1;return se.forEach(t=>{s.getProfile({actor:t.did}).then(n=>{if(e)return;const a=n.data;le(e=>({...e,[t.did]:{avatar:a.avatar,handle:a.handle}}))}).catch(()=>{})}),()=>{e=!0}},[ue,se,ce]);const{theme:me,setTheme:pe}=h(),{viewMode:fe,setViewMode:xe,cycleViewMode:ge}=m(),{cardViewMode:je,cycleCardView:be}=p(),{nsfwPreference:ve,cycleNsfwPreference:ye}=f(),{mediaMode:ke,cycleMediaMode:Ne}=x(),Ce=o.pathname,Se=T.useSyncExternalStore(Rn,Tn,()=>!1),Ee=g(),[,Le]=T.useState(!1),[Ae,Fe]=T.useState(!1),[Be,$e]=T.useState(!1),Pe=T.useRef(null),[Me,Te]=T.useState(null),[Re,We]=T.useState("all"),[De,Ie]=T.useState(!1),[He,Ue]=T.useState(null),[Oe,ze]=T.useState(!1),qe=T.useRef(!1),[Ke,Ve]=T.useState([]),[Ge,Ye]=T.useState(dn),[Qe,Je]=T.useState(un),[Xe,Ze]=T.useState(null),et=T.useRef(null),tt=T.useRef(null),nt=T.useRef(null),[at,st]=T.useState([]),[rt,it]=T.useState(!1),[ot,lt]=T.useState(0),ct=T.useRef(!1),[dt,ut]=T.useState(!1),[ht,mt]=T.useState(!1),[pt,ft]=T.useState(0),[xt,gt]=T.useState([{text:"",images:[],imageAlts:[]}]),[jt,bt]=T.useState(0),[vt,yt]=T.useState(!1),[wt,kt]=T.useState(null),Nt=T.useRef(null),Ct=T.useRef(null),_t=xt[jt]??{text:"",images:[],imageAlts:[]},[St,Et]=T.useState(!1),[Lt,At]=T.useState(!1),Ft=T.useRef(null),Bt=T.useRef(null),Pt=T.useRef(0),Mt=T.useRef(null),[Tt,Rt]=T.useState(!1),[Wt,Dt]=T.useState(!1),[It,Ht]=T.useState(0),Ut=T.useRef(null),Ot=T.useRef(null),zt=T.useRef(null),qt=T.useRef(null),Kt=T.useRef(null),Vt=T.useRef(""),Gt=T.useRef(""),Yt=T.useRef(null),Jt=T.useRef(null),Xt=T.useRef(!1),Zt=T.useRef(null),en=T.useRef(!1),tn=T.useRef(null),nn=T.useRef(!1),an=T.useRef(null),Wn=j(),Dn=b(),{entries:In,setEntryPercent:Hn,toggleSource:Un,addEntry:On,setSingleFeed:zn}=v(),qn=new Set(rn.map(e=>e.uri).filter(Boolean)),Kn=rn.filter(e=>!e.uri||!Ge.has(e.uri)),Vn=Ke.filter(e=>!e.uri||!qn.has(e.uri)),Gn=T.useMemo(()=>{const e=[...Kn,...Vn];if(0===Qe.length)return e;const t=new Map(Qe.map((e,t)=>[e,t]));return[...e].sort((e,n)=>(t.get(cn(e))??9999)-(t.get(cn(n))??9999))},[Kn,Vn,Qe]),Yn=Kn[0]??rn[0],Qn=T.useCallback(e=>{0===In.length?(On(Yn),On(e)):Un(e)},[In.length,On,Un]),Jn=T.useCallback(e=>{const t=e.map(cn).filter(Boolean);Je(t);try{localStorage.setItem(ln,JSON.stringify(t))}catch{}},[]),Xn=T.useMemo(()=>new Set([...Vn.map(e=>e.uri).filter(Boolean),...qn]),[Vn]),Zn=T.useCallback(()=>{Zt.current=setTimeout(()=>{Xt.current=!0,Wn?.clearSeenAndShowAll(),Zt.current=null},500)},[Wn]),ea=T.useCallback(()=>{Zt.current&&(clearTimeout(Zt.current),Zt.current=null)},[]),ta=T.useRef(null),na=T.useCallback(e=>{ta.current=e.currentTarget,tn.current=setTimeout(()=>{en.current=!0,Wn?.announceShowSeen(ta.current??void 0),Wn?.clearSeenAndShowAll(),tn.current=null},500)},[Wn]),aa=T.useCallback(()=>{tn.current&&(clearTimeout(tn.current),tn.current=null)},[]),sa=T.useCallback(e=>{en.current?en.current=!1:(Wn?.onHideSeenOnly(e?.currentTarget??void 0),"/feed"!==Ce&&l("/feed"))},[Wn,Ce,l]),ra=T.useCallback(()=>{an.current=setTimeout(()=>{nn.current=!0,Fe(!0),an.current=null},500)},[]),ia=T.useCallback(()=>{an.current&&(clearTimeout(an.current),an.current=null)},[]),oa=T.useCallback(()=>{if(nn.current)nn.current=!1;else if(ae){const e=oe[ae.did]?.handle??ae.handle??ae.did;Fe(!1),c(e)}else Fe(e=>!e)},[ae,oe,c]),la=T.useCallback(()=>{Xt.current?Xt.current=!1:O?(V(),"/feed"!==Ce&&l("/feed")):"/feed"===Ce?Wn?.onHomeClick():l("/feed")},[Ce,Wn,l,O,V]);T.useEffect(()=>{document.title=n?`${n} · ArtSky`:"ArtSky"},[n]),T.useEffect(()=>{const e=e=>{if(O)return;const t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||t.isContentEditable)return void("Escape"===e.key&&(e.preventDefault(),t.blur()));if(e.ctrlKey||e.metaKey)return;const n=e.key.toLowerCase();return"1"===n||"2"===n||"3"===n?(e.preventDefault(),void xe(n)):"t"===n?(e.preventDefault(),void Ne()):void("q"!==n&&"Backspace"!==e.key||("q"!==n||"/"!==o.pathname&&!o.pathname.startsWith("/feed"))&&(e.preventDefault(),l(-1)))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l,O,xe,Ne,o.pathname]),T.useEffect(()=>{if(!Ae)return;const e=e=>{const t=e.target;zt.current?.contains(t)||Ot.current?.contains(t)||Fe(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[Ae]),T.useEffect(()=>{if(!Lt)return;const e=e=>{const t=e.target;Ft.current?.contains(t)||Bt.current?.contains(t)||At(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[Lt]),T.useEffect(()=>{if(!Tt)return;const e=e=>{"Escape"===e.key&&(e.preventDefault(),Rt(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[Tt]),T.useEffect(()=>{if(!Wt)return;const e=e=>{"Escape"===e.key&&(e.preventDefault(),Dt(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[Wt]),T.useEffect(()=>{if(!Be)return;const e=e=>{const t=e.target;qt.current?.contains(t)||Kt.current?.contains(t)||$e(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[Be]);const ca=T.useCallback(async e=>{if(ae)try{const t=(await y()).filter(e=>"feed"===e.type&&e.pinned),n=await Promise.all(t.map(async e=>({kind:"custom",label:await w(e.value).catch(()=>e.value),uri:e.value}))),a=new Set(n.map(e=>e.uri).filter(Boolean));Ve(t=>{const s=[...n];for(const e of t)!e.uri||a.has(e.uri)||s.some(t=>t.uri===e.uri)||s.push(e);return e?.uri&&!s.some(t=>t.uri===e.uri)&&s.push(e),s})}catch{Ve([])}else Ve([])},[ae]),da=T.useCallback(async e=>{if(e.uri)if(ae){Ze(null);try{const t=await k(e.uri);await N(t);const n={kind:"custom",label:e.label??await w(t),uri:t};Ve(e=>e.some(e=>e.uri===t)?e:[...e,n]),Qn(n),await ca(n),l("/feed",{state:{feedSource:n}})}catch(t){Ze(t instanceof Error?t.message:"Could not add feed. Try again."),l("/feed",{state:{feedSource:e}})}}else l("/feed",{state:{feedSource:e}});else l("/feed",{state:{feedSource:e}})},[ae,l,Qn,ca]),ua=T.useCallback(async e=>{if(e.uri)try{await C(e.uri),Ve(t=>t.filter(t=>t.uri!==e.uri)),In.some(t=>t.source.uri===e.uri)&&Un(e),qn.has(e.uri)&&Ye(t=>{const n=new Set(t);n.add(e.uri);try{localStorage.setItem(on,JSON.stringify([...n]))}catch{}return n}),await ca()}catch{}},[In,Un,ca]),ha=T.useCallback(async e=>{if(e.uri)try{const t=await _(e.uri);await navigator.clipboard.writeText(t)}catch{}},[]);T.useEffect(()=>{ae&&ca()},[ae,ca]),T.useEffect(()=>{De&&ae&&ca()},[De,ae,ca]),T.useEffect(()=>{De&&Ze(null)},[De]),T.useEffect(()=>{qe.current&&!De&&Ue(360),qe.current=De},[De]),T.useEffect(()=>{if(!Oe||null!==He)return;const e=requestAnimationFrame(()=>{ze(!1)});return()=>cancelAnimationFrame(e)},[Oe,He]),T.useEffect(()=>{if(!De)return;const e=e=>{const t=e.target;et.current?.contains(t)||tt.current?.contains(t)||Ie(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[De]),T.useEffect(()=>{Be&&ae&&(it(!0),S(30).then(({notifications:e})=>{st(e),lt(0),E().then(()=>L().then(lt)).catch(()=>{})}).catch(()=>st([])).finally(()=>it(!1)))},[Be,ae]),T.useEffect(()=>{if(!Be||!ae||0===at.length)return;Gt.current=Vt.current,Jt.current=null;const e=setTimeout(()=>{const e=document.querySelectorAll("[data-notifications-list]");if(0===e.length)return;const t=()=>{const e=Gt.current;""!==e&&e!==Vt.current&&(Vt.current=e,E(e).then(()=>{st(t=>t.map(t=>t.indexedAt<=e?{...t,isRead:!0}:t));const t=at.filter(t=>t.indexedAt<=e&&!t.isRead).length;lt(e=>Math.max(0,e-t))}).catch(()=>{}))},n=new IntersectionObserver(e=>{for(const t of e){if(!t.isIntersecting)continue;const e=t.target.getAttribute("data-indexed-at");e&&(""===Gt.current||e>Gt.current)&&(Gt.current=e)}Yt.current&&clearTimeout(Yt.current),Yt.current=setTimeout(t,400)},{root:null,rootMargin:"0px",threshold:.25}),a=[];e.forEach(e=>{e.querySelectorAll("[data-indexed-at]").forEach(e=>{n.observe(e),a.push(e)})}),Jt.current=()=>{Yt.current&&clearTimeout(Yt.current),a.forEach(e=>n.unobserve(e))}},0);return()=>{clearTimeout(e),Jt.current?.(),Jt.current=null}},[Be,ae,at]),T.useEffect(()=>{ae?L().then(e=>{ct.current?lt(e):(ct.current=!0,lt(0))}).catch(()=>lt(0)):ct.current=!1},[ae]),T.useEffect(()=>{if(ae&&"undefined"!=typeof document)return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e);function e(){"visible"===document.visibilityState&&L().then(lt).catch(()=>{})}},[ae]);T.useRef(!1).current=Be;const ma=O||dt&&!Se||ht||Tt||Wt;function pa(){Se?(window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>Ut.current?.focus(),300)):(ut(!0),Ht(0),requestAnimationFrame(()=>{setTimeout(()=>{Ut.current?.focus({preventScroll:!1})},200)}))}function fa(){ut(!1),Ut.current?.blur()}T.useEffect(()=>{if(Ee&&ma)return Ee.lockScroll(),()=>Ee.unlockScroll()},[ma,Ee]),T.useEffect(()=>{if(!dt||"undefined"==typeof window)return;const e=window.visualViewport;if(!e)return;const t=e;function n(){Ht(window.innerHeight-(t.offsetTop+t.height))}return n(),t.addEventListener("resize",n),t.addEventListener("scroll",n),()=>{t.removeEventListener("resize",n),t.removeEventListener("scroll",n)}},[dt]),T.useEffect(()=>{if(!dt||Se)return;const e=setTimeout(()=>{Ut.current?.focus({preventScroll:!1})},100);return()=>clearTimeout(e)},[dt,Se]),T.useEffect(()=>{if(!ht||Se||"undefined"==typeof window)return;const e=window.visualViewport;if(!e)return;const t=e;function n(){ft(window.innerHeight-(t.offsetTop+t.height))}return n(),t.addEventListener("resize",n),t.addEventListener("scroll",n),()=>{t.removeEventListener("resize",n),t.removeEventListener("scroll",n)}},[ht,Se]),T.useEffect(()=>{if("undefined"==typeof window||Se)return;Pt.current=window.scrollY;function e(){const e=window.scrollY,t=e-Pt.current;t>8?(Et(!0),At(!1)):t<-8&&Et(!1),Pt.current=e,Mt.current&&clearTimeout(Mt.current),Mt.current=setTimeout(()=>{Mt.current=null,Et(!1)},350)}return window.addEventListener("scroll",e,{passive:!0}),()=>{window.removeEventListener("scroll",e),Mt.current&&clearTimeout(Mt.current)}},[Se]);function xa(){mt(!0),gt([{text:"",images:[],imageAlts:[]}]),bt(0),kt(null),ft(0)}function ga(){mt(!1),kt(null)}const ja=["image/jpeg","image/png","image/gif","image/webp"];function ba(e){const t=Array.from(e).filter(e=>ja.includes(e.type)),n=_t,a=Math.min(t.length,4-n.images.length);if(a<=0)return;const s=t.slice(0,a);gt(e=>{const t=[...e],n=t[jt];return n&&(t[jt]={...n,images:[...n.images,...s],imageAlts:[...n.imageAlts,...s.map(()=>"")]}),t})}const va=T.useMemo(()=>_t.images.map(e=>URL.createObjectURL(e)),[_t.images]);T.useEffect(()=>()=>va.forEach(e=>URL.revokeObjectURL(e)),[va]);const ya=dt&&!Se,wa="/feed"===Ce&&!O&&!ya,ka=e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:wa?U.navActive:"","aria-current":wa?"page":void 0,onPointerDown:Zn,onPointerUp:ea,onPointerLeave:ea,onPointerCancel:ea,onClick:la,title:"Home (hold to show all seen posts)",children:[e.jsx("span",{className:U.navIcon,children:e.jsx(mn,{active:wa})}),e.jsx("span",{className:U.navLabel,children:"Home"})]}),Se&&e.jsxs("button",{type:"button",className:Z&&!ya?U.navActive:"",onClick:K,"aria-pressed":Z,children:[e.jsx("span",{className:U.navIcon,children:e.jsx(fn,{})}),e.jsx("span",{className:U.navLabel,children:"Collections"})]}),e.jsxs("button",{type:"button",className:U.navBtn,onClick:xa,"aria-label":"New post",children:[e.jsx("span",{className:U.navIcon,children:e.jsx(_n,{})}),e.jsx("span",{className:U.navLabel,children:"New"})]}),e.jsxs("button",{type:"button",className:ya?U.navActive:U.navBtn,onClick:pa,"aria-label":"Search","aria-pressed":ya,children:[e.jsx("span",{className:U.navIcon,children:e.jsx(xn,{active:ya})}),e.jsx("span",{className:U.navLabel,children:"Search"})]}),e.jsxs("button",{type:"button",className:X&&!ya?U.navActive:"",onClick:q,"aria-pressed":X,children:[e.jsx("span",{className:U.navIcon,children:e.jsx(gn,{})}),e.jsx("span",{className:U.navLabel,children:"Forums"})]})]}),Na=e.jsx(e.Fragment,{children:Se?ka:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:U.navHomeWrap,children:e.jsx("button",{type:"button",className:wa?U.navActive:"","aria-current":wa?"page":void 0,onPointerDown:Zn,onPointerUp:ea,onPointerLeave:ea,onPointerCancel:ea,onClick:la,title:"Home (hold to show all read posts)",children:e.jsx("span",{className:U.navIcon,children:e.jsx(mn,{active:wa})})})}),e.jsx("button",{type:"button",className:X&&!ya?U.navActive:"",onClick:q,"aria-pressed":X,"aria-label":"Forums",children:e.jsx("span",{className:U.navIcon,children:e.jsx(gn,{})})}),e.jsx("button",{type:"button",className:U.navBtn,onClick:xa,"aria-label":"New post",children:e.jsx("span",{className:U.navIcon,children:e.jsx(_n,{})})}),e.jsx("button",{type:"button",className:ya?U.navActive:U.navBtn,onClick:pa,"aria-label":"Search","aria-pressed":ya,children:e.jsx("span",{className:U.navIcon,children:e.jsx(xn,{active:ya})})}),e.jsx("div",{className:U.navProfileWrap,children:e.jsx("button",{ref:Ot,type:"button",className:U.navProfileBtn,onPointerDown:ra,onPointerUp:ia,onPointerLeave:ia,onPointerCancel:ia,onClick:oa,"aria-label":ae?"Profile (hold for accounts)":"Account","aria-expanded":Ae,title:ae?"Profile (hold for accounts and settings)":"Account",children:e.jsx("span",{className:U.navIcon,children:ae&&he?e.jsx("img",{src:he,alt:"",className:U.navProfileAvatar,loading:"lazy"}):e.jsx(bn,{})})})})]})}),Ca=e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:U.menuTitle,children:"Notifications"}),e.jsxs("div",{className:U.notificationFilters,children:[e.jsx("button",{type:"button",className:"all"===Re?U.notificationFilterActive:U.notificationFilter,onClick:()=>We("all"),children:"All"}),e.jsx("button",{type:"button",className:"reply"===Re?U.notificationFilterActive:U.notificationFilter,onClick:()=>We("reply"),children:"Replies"}),e.jsx("button",{type:"button",className:"follow"===Re?U.notificationFilterActive:U.notificationFilter,onClick:()=>We("follow"),children:"Follows"})]}),rt?e.jsx("p",{className:U.notificationsLoading,children:"Loading…"}):(()=>{const t="all"===Re?at:at.filter(e=>e.reason===Re);return 0===t.length?e.jsx("p",{className:U.notificationsEmpty,children:"all"===Re?"No notifications yet.":"No matching notifications."}):e.jsx("ul",{className:U.notificationsList,"data-notifications-list":!0,children:t.map(t=>{const n=t.author.handle??t.author.did,a="follow"===t.reason,s="reply"===t.reason||"like"===t.reason,r=a?`/profile/${encodeURIComponent(n)}`:`/post/${encodeURIComponent(t.reasonSubject??t.uri)}`,i="like"===t.reason?"liked your post":"repost"===t.reason?"reposted your post":"follow"===t.reason?"followed you":"mention"===t.reason?"mentioned you":"reply"===t.reason?"replied to you":"quote"===t.reason?"quoted your post":t.reason,o=!Se&&(a||s||"repost"===t.reason||"mention"===t.reason||"quote"===t.reason);return e.jsx("li",{"data-indexed-at":t.indexedAt,children:e.jsxs(I,{to:r,className:U.notificationItem,onClick:e=>{$e(!1),o?(e.preventDefault(),a?c(n):s?H(t.uri,void 0,t.uri):H(t.reasonSubject??t.uri)):a&&(e.preventDefault(),c(n))},children:[t.author.avatar?e.jsx("img",{src:t.author.avatar,alt:"",className:U.notificationAvatar,loading:"lazy"}):e.jsx("span",{className:U.notificationAvatarPlaceholder,"aria-hidden":!0,children:n.slice(0,1).toUpperCase()}),e.jsxs("span",{className:U.notificationTextWrap,children:[e.jsxs("span",{className:U.notificationText,children:[e.jsxs("strong",{children:["@",n]})," ",i]}),t.replyPreview&&e.jsx("span",{className:U.notificationReplyPreview,children:t.replyPreview})]})]})},t.uri)})})})()]}),_a=e.jsxs(e.Fragment,{children:[ae&&e.jsx(e.Fragment,{children:e.jsxs("section",{className:U.menuSection,children:[e.jsxs("div",{className:U.menuProfileAndAccounts,children:[e.jsxs("button",{type:"button",className:`${U.menuProfileBtn} ${U.menuProfileBtnAccentHover}`,onClick:()=>{Fe(!1),Le(!1),K()},title:"Collections",children:[e.jsx("span",{className:U.menuProfileIconWrap,"aria-hidden":!0,children:e.jsx(fn,{})}),e.jsx("span",{children:"Collections"})]}),e.jsx("div",{className:U.menuAccountsBlock,children:se.map(t=>{const n=oe[t.did],a=n?.handle??t.handle??t.did,s=t.did===ae?.did;return e.jsxs("button",{type:"button",className:s?U.menuItemActive:U.menuItem,onClick:()=>{s?(Fe(!1),Le(!1),c(a)):async function(e){await ie(e)&&(Le(!1),Fe(!1))}(t.did)},title:s?"View my profile":`Switch to @${a}`,children:[n?.avatar?e.jsx("img",{src:n.avatar,alt:"",className:U.accountMenuAvatar,loading:"lazy"}):e.jsx("span",{className:U.accountMenuAvatarPlaceholder,"aria-hidden":!0,children:(a||t.did).slice(0,1).toUpperCase()}),s?e.jsxs("span",{className:U.menuAccountLabel,children:[e.jsxs("span",{className:U.menuAccountLabelDefault,children:["@",a]}),e.jsx("span",{className:U.menuAccountLabelHover,children:"Open profile"})]}):e.jsxs("span",{children:["@",a]}),s&&e.jsx("span",{className:U.sheetCheck,"aria-hidden":!0,children:" ✓"})]},t.did)})})]}),e.jsxs("div",{className:U.menuActions,children:[e.jsx("button",{type:"button",className:U.menuActionBtn,onClick:function(){Le(!1),Fe(!1),te()},children:"Add account"}),e.jsx("button",{type:"button",className:U.menuActionSecondary,onClick:function(){Le(!1),Fe(!1),re()},children:"Log out"})]})]})}),!ae&&e.jsx("section",{className:U.menuSection,children:e.jsxs("div",{className:U.menuProfileAndAccounts,children:[Se?e.jsxs("button",{type:"button",className:`${U.menuProfileBtn} ${U.menuProfileBtnAccentHover}`,onClick:()=>{Fe(!1),Le(!1),te("create")},children:[e.jsx("span",{className:U.menuProfileIconWrap,"aria-hidden":!0,children:e.jsx(bn,{})}),e.jsx("span",{children:"Create account"})]}):e.jsxs("a",{href:"https://bsky.app",target:"_blank",rel:"noopener noreferrer",className:`${U.menuProfileBtn} ${U.menuProfileBtnAccentHover}`,onClick:()=>{Fe(!1),Le(!1)},children:[e.jsx("span",{className:U.menuProfileIconWrap,"aria-hidden":!0,children:e.jsx(bn,{})}),e.jsx("span",{children:"Create account"})]}),e.jsx("div",{className:U.menuAccountsBlock,children:e.jsxs("button",{type:"button",className:U.menuAuthLink,onClick:()=>{Fe(!1),Le(!1),te()},children:[e.jsx(En,{}),e.jsx("span",{children:"Log in with Bluesky"})]})})]})})]}),Sa=T.useMemo(()=>({wrapperRef:i&&"/feed"===Ce?Pe:null,setHandlers:i&&"/feed"===Ce?Te:null}),[i,Ce]);return e.jsx("div",{className:`${U.wrap} ${i&&Se?U.wrapWithHeader:""} ${i&&!Se?U.wrapMobileTop:""}`,children:e.jsx(hn.Provider,{value:Sa,children:e.jsxs(ee,{feedSources:ae?Gn:Q,setSingleFeed:zn,children:[e.jsx("a",{href:"#main-content",className:U.skipLink,children:"Skip to main content"}),i&&Se&&e.jsx("header",{className:`${U.header} ${ae?"":U.headerLoggedOut}`,role:"banner",children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:U.headerLeft,children:[Se&&e.jsxs("div",{ref:Bt,className:U.headerGearWrap,children:[e.jsx("button",{type:"button",className:`${U.headerGearBtn} float-btn ${Lt?U.feedFloatGearActive:""}`,onClick:()=>At(e=>!e),title:Lt?"Hide view options":"Show view options","aria-label":Lt?"Hide view options":"Show view options","aria-expanded":Lt,children:e.jsx(Bn,{})}),e.jsxs("div",{className:`${U.headerGearExpandable} ${U.gearFloatExpandable} ${Lt?U.feedFloatButtonsExpandableOpen:""}`,"aria-hidden":!Lt,children:[e.jsxs("button",{type:"button",className:`${U.nsfwFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:e=>ye(e.currentTarget,{showToast:!1}),title:`${ve}. Click to cycle: SFW → Blurred → NSFW`,"aria-label":`Content: ${ve}. Click to cycle.`,children:[e.jsx(yn,{mode:"sfw"===ve?"closed":"blurred"===ve?"half":"open"}),e.jsx("span",{className:U.gearExpandableLabel,children:A[ve]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>pe("light"===me?"system":"system"===me?"dark":"light"),title:`Theme: ${me}. Click to cycle.`,"aria-label":`Theme: ${me}. Click to cycle.`,children:[e.jsx("span",{className:U.feedFloatThemeIcon,children:"light"===me?e.jsx(Ln,{}):"dark"===me?e.jsx(An,{}):e.jsx(Fn,{})}),e.jsx("span",{className:U.gearExpandableLabel,children:"light"===me?"Light":"dark"===me?"Dark":"Auto"})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:e=>be(e.currentTarget,{showToast:!1}),title:F[je],"aria-label":F[je],children:[e.jsx(wn,{mode:"default"===je?"default":"minimalist"===je?"minimalist":"artOnly"}),e.jsx("span",{className:U.gearExpandableLabel,children:F[je]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>Ne({showToast:!1}),title:`${B[ke]}. Click to cycle: All Posts → Media only → Text only.`,"aria-label":B[ke],children:[e.jsx(Mn,{}),e.jsx("span",{className:U.gearExpandableLabel,children:B[ke]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:e=>ge(e.currentTarget,{showToast:!1}),title:`${$[fe]}. Click to cycle.`,"aria-label":`Columns: ${$[fe]}. Click to cycle.`,children:["1"===fe&&e.jsx(kn,{}),"2"===fe&&e.jsx(Nn,{}),"3"===fe&&e.jsx(Cn,{}),e.jsx("span",{className:U.gearExpandableLabel,children:$[fe]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>{At(!1),Dt(!0)},title:"Storage and cache management","aria-label":"Storage & Cache",children:[e.jsx(Pn,{}),e.jsx("span",{className:U.gearExpandableLabel,children:"Storage & Cache"})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>Rt(!0),title:"About ArtSky and keyboard shortcuts","aria-label":"About ArtSky",children:[e.jsx($n,{}),e.jsx("span",{className:U.gearExpandableLabel,children:"About"})]})]})]}),e.jsxs("button",{type:"button",className:U.logoLink,"aria-label":"ArtSky – back to feed",title:"/feed"===Ce?"Home (hold to show all read posts)":"Back to feed",onPointerDown:Zn,onPointerUp:ea,onPointerLeave:ea,onPointerCancel:ea,onClick:la,children:[e.jsx("img",{src:"/artsky-dev/icon.svg",alt:"",className:U.logoIcon}),e.jsx("span",{className:U.logoText,children:"ArtSky"}),e.jsx("span",{className:U.logoDev,children:" dev"})]})]}),e.jsx("div",{className:U.headerCenter,children:Se?e.jsxs("div",{className:U.headerSearchRow,children:[e.jsx("div",{className:U.headerSearchSide,children:e.jsxs("div",{className:U.headerFeedsWrap,ref:et,children:[e.jsx("button",{ref:tt,type:"button",className:De?U.headerFeedsLinkActive:U.headerFeedsLink,"aria-label":"Feeds","aria-expanded":De,onClick:()=>Ie(e=>!e),children:"Feeds"}),De&&e.jsxs("div",{className:U.feedsDropdown,role:"dialog","aria-label":"Remix feeds",children:[Xe&&e.jsx("p",{className:U.feedAddError,role:"alert",children:Xe}),e.jsx($t,{variant:"dropdown",sources:ae?Gn:Q,fallbackSource:ae?Yn:Q[0],mixEntries:ae?In:J,onToggle:Qn,setEntryPercent:Hn,onAddCustom:async e=>{if(ae){Ze(null);try{const t="object"==typeof e&&null!==e&&"uri"in e,n=t?await k(e.uri):await k(e);await N(n);const a={kind:"custom",label:t?e.label??await w(n):await w(n),uri:n};Ve(e=>e.some(e=>e.uri===n)?e:[...e,a]),Qn(a),await ca(a)}catch(t){Ze(t instanceof Error?t.message:"Could not add feed. Try again.")}}},onToggleWhenGuest:ae?void 0:te,removableSourceUris:ae?Xn:void 0,onRemoveFeed:ae?ua:void 0,onShareFeed:ae?ha:void 0,onReorderSources:ae?Jn:void 0})]})]})}),e.jsx("div",{className:U.headerSearchBarWrap,children:e.jsx(we,{inputRef:Ut,compact:Se,onSelectFeed:da})}),e.jsx("div",{className:U.headerSearchSide,children:e.jsx("button",{type:"button",className:ae?U.headerForumLink:U.headerForumLinkLoggedOut,"aria-label":"Forums",onClick:q,children:"Forums"})})]}):e.jsx("div",{className:U.headerCenterMobile,children:e.jsxs("div",{className:U.headerFeedsWrap,ref:et,children:[e.jsxs("button",{ref:tt,type:"button",className:De?U.headerFeedsBtnActive:U.headerFeedsBtn,"aria-label":"Feeds","aria-expanded":De,onClick:()=>Ie(e=>!e),children:[e.jsx(jn,{}),e.jsx("span",{className:U.headerFeedsBtnLabel,children:"Feeds"})]}),De&&e.jsxs("div",{className:U.feedsDropdown,role:"dialog","aria-label":"Remix feeds",children:[Xe&&e.jsx("p",{className:U.feedAddError,role:"alert",children:Xe}),e.jsx($t,{variant:"dropdown",sources:ae?Gn:Q,fallbackSource:ae?Yn:Q[0],mixEntries:ae?In:J,onToggle:Qn,setEntryPercent:Hn,onAddCustom:async e=>{if(ae){Ze(null);try{const t="object"==typeof e&&null!==e&&"uri"in e,n=t?await k(e.uri):await k(e);await N(n);const a={kind:"custom",label:t?e.label??await w(n):await w(n),uri:n};Ve(e=>e.some(e=>e.uri===n)?e:[...e,a]),Qn(a),await ca(a)}catch(t){Ze(t instanceof Error?t.message:"Could not add feed. Try again.")}}},onToggleWhenGuest:ae?void 0:te,removableSourceUris:ae?Xn:void 0,onRemoveFeed:ae?ua:void 0,onShareFeed:ae?ha:void 0,onReorderSources:ae?Jn:void 0})]})]})})}),e.jsxs("div",{className:U.headerRight,children:[ae&&Se&&e.jsxs("button",{type:"button",className:U.headerBtnWithLabel,onClick:xa,"aria-label":"New post",title:"New post",children:[e.jsx(_n,{}),e.jsx("span",{className:U.headerBtnLabel,children:"New"})]}),ae&&e.jsxs("div",{className:U.headerBtnWrap,children:[e.jsx("button",{ref:Kt,type:"button",className:U.headerBtn,onClick:()=>$e(e=>!e),"aria-label":"Notifications","aria-expanded":Be,title:"Notifications",children:e.jsx(vn,{})}),ot>0&&e.jsx("span",{className:U.notificationUnreadDot,"aria-hidden":!0}),Be&&e.jsx("div",{ref:qt,className:U.notificationsMenu,role:"dialog","aria-label":"Notifications",children:Ca})]}),Se&&e.jsxs(e.Fragment,{children:[!ae&&e.jsx("button",{type:"button",className:U.headerAuthLink,onClick:()=>te(),children:"Log in"}),e.jsxs("div",{className:U.headerBtnWrap,children:[e.jsx("button",{ref:Ot,type:"button",className:U.headerBtn,onPointerDown:ra,onPointerUp:ia,onPointerLeave:ia,onPointerCancel:ia,onClick:oa,"aria-label":"Profile (hold for accounts)","aria-expanded":Ae,title:"Profile (hold for accounts and settings)",children:e.jsx("span",{className:U.navIcon,children:he?e.jsx("img",{src:he,alt:"",className:U.headerAccountAvatar,loading:"lazy"}):e.jsx(bn,{})})}),Ae&&e.jsx("div",{ref:zt,className:U.accountMenu,role:"menu","aria-label":"Accounts and settings",children:_a})]})]}),!Se&&e.jsxs(e.Fragment,{children:[!ae&&e.jsx("button",{type:"button",className:U.headerAuthLink,onClick:()=>te(),children:"Log in"}),e.jsxs("div",{className:U.headerAccountMenuWrap,children:[e.jsx("button",{ref:Ot,type:"button",className:U.headerAccountNavBtn,onPointerDown:ra,onPointerUp:ia,onPointerLeave:ia,onPointerCancel:ia,onClick:oa,"aria-label":"Profile (hold for accounts)","aria-expanded":Ae,title:"Profile (hold for accounts and settings)",children:e.jsx("span",{className:U.navIcon,children:he?e.jsx("img",{src:he,alt:"",className:U.headerAccountAvatar,loading:"lazy"}):e.jsx(bn,{})})}),Ae&&e.jsx("div",{ref:zt,className:U.accountMenu,role:"menu","aria-label":"Accounts and settings",children:_a})]})]})]})]})}),i&&!Se&&e.jsxs("div",{className:`${U.feedsFloatWrap} feeds-float-wrap ${St||O&&z?U.feedsFloatWrapScrollHidden:""}`,ref:et,children:[e.jsxs("button",{ref:tt,type:"button",className:`${U.feedsFloatBtn} float-btn ${De?U.feedsFloatBtnActive:""}`,onClick:()=>Ie(e=>!e),"aria-label":"Feeds","aria-expanded":De,children:[e.jsx("span",{className:U.feedsFloatLabel,children:"Feeds"}),e.jsx("span",{ref:nt,className:`${U.feedsFloatChevronWrap} ${Oe?U.feedsFloatChevronWrapNoTransition:""}`,style:{transform:`rotate(${De?180:He??0}deg)`},onTransitionEnd:()=>{360===He&&(W.flushSync(()=>ze(!0)),Ue(null))},children:e.jsx(Sn,{})})]}),De&&e.jsxs("div",{className:U.feedsDropdown,role:"dialog","aria-label":"Remix feeds",children:[Xe&&e.jsx("p",{className:U.feedAddError,role:"alert",children:Xe}),e.jsx($t,{variant:"dropdown",touchFriendly:!0,sources:ae?Gn:Q,fallbackSource:ae?Yn:Q[0],mixEntries:ae?In:J,onToggle:Qn,setEntryPercent:Hn,onAddCustom:async e=>{if(ae){Ze(null);try{const t="object"==typeof e&&null!==e&&"uri"in e,n=t?await k(e.uri):await k(e);await N(n);const a={kind:"custom",label:t?e.label??await w(n):await w(n),uri:n};Ve(e=>e.some(e=>e.uri===n)?e:[...e,a]),Qn(a),await ca(a)}catch(t){Ze(t instanceof Error?t.message:"Could not add feed. Try again.")}}},onToggleWhenGuest:ae?void 0:te,removableSourceUris:ae?Xn:void 0,onRemoveFeed:ae?ua:void 0,onShareFeed:ae?ha:void 0,onReorderSources:ae?Jn:void 0})]})]}),i&&!Se&&"/feed"===Ce&&e.jsxs("div",{ref:Ft,className:`${U.gearFloatWrap} ${St||O&&z?U.gearFloatWrapScrollHidden:""}`,children:[e.jsx("button",{type:"button",className:`${U.feedFloatBtn} float-btn ${Lt?U.feedFloatGearActive:""}`,onClick:()=>At(e=>!e),title:Lt?"Hide view options":"Show view options","aria-label":Lt?"Hide view options":"Show view options","aria-expanded":Lt,children:e.jsx(Bn,{})}),e.jsxs("div",{className:`${U.feedFloatButtonsExpandable} ${U.gearFloatExpandable} ${Lt?U.feedFloatButtonsExpandableOpen:""}`,"aria-hidden":!Lt,children:[e.jsxs("button",{type:"button",className:`${U.nsfwFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:e=>ye(e.currentTarget,{showToast:!1}),title:`${ve}. Click to cycle: SFW → Blurred → NSFW`,"aria-label":`Content: ${ve}. Click to cycle.`,children:[e.jsx(yn,{mode:"sfw"===ve?"closed":"blurred"===ve?"half":"open"}),e.jsx("span",{className:U.gearExpandableLabel,children:A[ve]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>pe("light"===me?"system":"system"===me?"dark":"light"),title:`Theme: ${me}. Click to cycle.`,"aria-label":`Theme: ${me}. Click to cycle.`,children:[e.jsx("span",{className:U.feedFloatThemeIcon,children:"light"===me?e.jsx(Ln,{}):"dark"===me?e.jsx(An,{}):e.jsx(Fn,{})}),e.jsx("span",{className:U.gearExpandableLabel,children:"light"===me?"Light":"dark"===me?"Dark":"Auto"})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:e=>be(e.currentTarget,{showToast:!1}),title:F[je],"aria-label":F[je],children:[e.jsx(wn,{mode:"default"===je?"default":"minimalist"===je?"minimalist":"artOnly"}),e.jsx("span",{className:U.gearExpandableLabel,children:F[je]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>Ne({showToast:!1}),title:`${B[ke]}. Click to cycle: All Posts → Media only → Text only.`,"aria-label":B[ke],children:[e.jsx(Mn,{}),e.jsx("span",{className:U.gearExpandableLabel,children:B[ke]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:e=>ge(e.currentTarget,{showToast:!1}),title:`${$[fe]}. Click to cycle.`,"aria-label":`Columns: ${$[fe]}. Click to cycle.`,children:["1"===fe&&e.jsx(kn,{}),"2"===fe&&e.jsx(Nn,{}),"3"===fe&&e.jsx(Cn,{}),e.jsx("span",{className:U.gearExpandableLabel,children:$[fe]})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>{At(!1),Dt(!0)},title:"Storage and cache management","aria-label":"Storage & Cache",children:[e.jsx(Pn,{}),e.jsx("span",{className:U.gearExpandableLabel,children:"Storage & Cache"})]}),e.jsxs("button",{type:"button",className:`${U.feedFloatBtn} ${U.gearExpandableBtn} float-btn`,onClick:()=>Rt(!0),title:"About ArtSky and keyboard shortcuts","aria-label":"About ArtSky",children:[e.jsx($n,{}),e.jsx("span",{className:U.gearExpandableLabel,children:"About"})]})]})]}),i&&!Se&&!ae&&e.jsx("div",{className:`${U.loginFloatWrap} login-float-wrap ${St||O&&z?U.loginFloatWrapScrollHidden:""}`,children:e.jsx("button",{type:"button",className:`${U.loginFloatBtn} float-btn`,onClick:()=>te(),"aria-label":"Log in",title:"Log in",children:"Log in"})}),i&&!Se&&ae&&e.jsxs("div",{className:`${U.notificationFloatWrap} notification-float-wrap ${St||O&&z?U.notificationFloatWrapScrollHidden:""}`,children:[e.jsxs("button",{ref:Kt,type:"button",className:U.notificationFloatBtn,onClick:()=>$e(e=>!e),"aria-label":"Notifications","aria-expanded":Be,title:"Notifications",children:[e.jsx(vn,{}),ot>0&&e.jsx("span",{className:U.notificationUnreadDot,"aria-hidden":!0})]}),Be&&e.jsx("div",{ref:qt,className:U.notificationsMenu,role:"dialog","aria-label":"Notifications",children:Ca})]}),i&&!Se&&Ae&&e.jsx("div",{className:U.accountMenuAboveWrap,children:e.jsx("div",{ref:zt,className:U.accountMenuAbove,role:"menu","aria-label":"Accounts and settings",children:_a})}),e.jsx("main",{id:"main-content",className:U.main,"aria-label":"Main content",children:i&&"/feed"===Ce?e.jsxs("div",{ref:Pe,onTouchStart:Me?.onTouchStart,onTouchMove:Me?.onTouchMove,onTouchEnd:Me?.onTouchEnd,children:[e.jsx($t,{variant:"page",sources:ae?Gn:Q,fallbackSource:ae?Yn:Q[0],mixEntries:ae?In:J,onToggle:Qn,setEntryPercent:Hn,onAddCustom:async e=>{if(ae){Ze(null);try{const t="object"==typeof e&&null!==e&&"uri"in e,n=t?await k(e.uri):await k(e);await N(n);const a={kind:"custom",label:t?e.label??await w(n):await w(n),uri:n};Ve(e=>e.some(e=>e.uri===n)?e:[...e,a]),Qn(a),await ca(a)}catch(t){Ze(t instanceof Error?t.message:"Could not add feed. Try again.")}}},onToggleWhenGuest:ae?void 0:te,removableSourceUris:ae?Xn:void 0,onRemoveFeed:ae?ua:void 0,onShareFeed:ae?ha:void 0,onReorderSources:ae?Jn:void 0}),a]}):a}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${U.navOuter} nav-outer  ${!Se&&(St||O&&z)?U.navOuterScrollHidden:""}`,children:[!O&&e.jsx("button",{type:"button",className:`${U.seenPostsFloatBtn} hide-seen-fab float-btn`,onPointerDown:e=>na(e),onPointerUp:aa,onPointerLeave:aa,onPointerCancel:aa,onClick:e=>sa(e),title:"Tap to hide read posts, hold to show them again","aria-label":"Read posts: tap to hide, hold to show again",children:e.jsx(pn,{})}),e.jsx("nav",{className:`${U.nav} nav`,"aria-label":"Main navigation",children:Na})]}),dt&&!Se&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:U.searchOverlayBackdrop,onClick:fa,"aria-hidden":!0}),e.jsx("div",{className:`${U.searchOverlayCenter} ${Se?U.searchOverlayAboveKeyboard:U.searchOverlayMobileBottom}`,role:"dialog","aria-label":"Search",style:Se?{bottom:It}:void 0,children:e.jsx("div",{className:U.searchOverlayCard,children:e.jsx(we,{inputRef:Ut,onClose:fa,suggestionsAbove:!0,onSelectFeed:da})})})]}),ht&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:U.searchOverlayBackdrop,onClick:ga,"aria-hidden":!0}),e.jsx("div",{className:`${U.composeOverlay} ${Se?"":U.composeOverlayMobile}`,role:"dialog","aria-label":"New post",onClick:ga,onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.preventDefault(),e.dataTransfer?.files?.length&&ba(e.dataTransfer.files)},style:Se?void 0:{bottom:pt},children:e.jsxs("div",{className:U.composeCard,onClick:e=>e.stopPropagation(),children:[e.jsxs("header",{className:U.composeHeader,children:[e.jsx("button",{type:"button",className:U.composeCancel,onClick:ga,disabled:vt,children:"Cancel"}),e.jsx("h2",{className:U.composeTitle,children:"New post"}),e.jsx("div",{className:U.composeHeaderPostWrap,children:ae&&e.jsx("button",{type:"submit",form:"compose-form",className:U.composeSubmit,disabled:vt||xt.every(e=>!e.text.trim()&&0===e.images.length),children:vt?"Posting…":"Post"})})]}),ae?e.jsxs("form",{id:"compose-form",ref:Ct,onSubmit:async function(e){if(e.preventDefault(),!ae||vt)return;const t=xt.filter(e=>e.text.trim()||e.images.length>0);if(0!==t.length){kt(null),yt(!0);try{let e=null,n=null,a=null,s=null;for(let r=0;r<t.length;r++){const i=t[r];if(0===r){const t=await P(i.text,i.images.length>0?i.images:void 0,i.imageAlts.length>0?i.imageAlts:void 0);e=t.uri,n=t.cid,a=t.uri,s=t.cid}else{if(!i.text.trim())continue;const t=await M(e,n,a,s,i.text);a=t.uri,s=t.cid}}gt([{text:"",images:[],imageAlts:[]}]),bt(0),ga(),l("/feed")}catch(n){kt(n instanceof Error?n.message:"Failed to post")}finally{yt(!1)}}},children:[xt.length>1&&e.jsxs("div",{className:U.composePreviousPosts,role:"region","aria-label":"Posts in thread",children:[e.jsx("p",{className:U.composePreviousPostsTitle,children:"Posts in thread — click to edit"}),e.jsx("div",{className:U.composePreviousPostsList,children:xt.map((t,n)=>n===jt?null:e.jsxs("button",{type:"button",className:U.composePreviousPostCard,onClick:()=>bt(n),disabled:vt,"aria-label":`Edit post ${n+1}`,children:[e.jsxs("span",{className:U.composePreviousPostLabel,children:["Post ",n+1]}),t.text.trim()?e.jsx("div",{className:U.composePreviousPostText,children:e.jsx(Y,{text:t.text,interactive:!1})}):t.images.length>0?null:e.jsx("div",{className:U.composePreviousPostText,children:e.jsx("em",{children:"Empty"})}),t.images.length>0&&e.jsxs("p",{className:U.composePreviousPostMedia,children:[t.images.length," image",1!==t.images.length?"s":""]})]},n))})]}),xt.length>1&&e.jsxs("p",{className:U.composeSegmentLabel,children:["Post ",jt+1," of ",xt.length]}),e.jsx(Qt,{className:U.composeTextarea,value:_t.text,onChange:function(e){gt(t=>{const n=[...t],a=n[jt];return a&&(n[jt]={...a,text:e}),n})},onKeyDown:e=>function(e,t){"Enter"!==e.key&&"E"!==e.key||!e.metaKey&&!e.ctrlKey||(e.preventDefault(),t&&(_t.text.trim()||_t.images.length>0)&&!vt&&t.requestSubmit())}(e,Ct.current),placeholder:"What's on your mind? Type @ for users, # for hashtags, % for forum posts",rows:4,maxLength:300,disabled:vt,autoFocus:Se}),_t.images.length>0&&e.jsxs("div",{className:U.composeMediaSection,children:[e.jsx("div",{className:U.composePreviews,children:_t.images.map((t,n)=>e.jsxs("div",{className:U.composePreviewWrap,children:[e.jsx("img",{src:va[n],alt:"",className:U.composePreviewImg}),e.jsx("button",{type:"button",className:U.composePreviewRemove,onClick:()=>{return e=n,void gt(t=>{const n=[...t],a=n[jt];return a&&(n[jt]={...a,images:a.images.filter((t,n)=>n!==e),imageAlts:a.imageAlts.filter((t,n)=>n!==e)}),n});var e},"aria-label":"Remove image",disabled:vt,children:"×"})]},n))}),e.jsx("p",{className:U.composeAltPrompt,children:"Describe each image for accessibility (alt text)."}),e.jsx("div",{className:U.composeAltFields,children:_t.images.map((t,n)=>e.jsxs("div",{className:U.composeAltRow,children:[e.jsxs("label",{htmlFor:`compose-alt-${jt}-${n}`,className:U.composeAltLabel,children:["Image ",n+1]}),e.jsx("input",{id:`compose-alt-${jt}-${n}`,type:"text",className:U.composeAltInput,placeholder:"Describe this image for people using screen readers",value:_t.imageAlts[n]??"",onChange:e=>{const t=e.target.value.slice(0,1e3);gt(e=>{const a=[...e],s=a[jt];if(!s)return e;const r=[...s.imageAlts];for(;r.length<s.images.length;)r.push("");return r[n]=t,a[jt]={...s,imageAlts:r},a})},maxLength:1e3,disabled:vt,"aria-label":`Alt text for image ${n+1}`})]},n))})]}),e.jsxs("div",{className:U.composeFooter,children:[e.jsxs("div",{className:U.composeFooterLeft,children:[e.jsx("input",{ref:Nt,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",multiple:!0,className:U.composeFileInput,onChange:e=>{e.target.files?.length&&ba(e.target.files),e.target.value=""}}),e.jsx("button",{type:"button",className:U.composeAddMedia,onClick:()=>Nt.current?.click(),disabled:vt||_t.images.length>=4,title:"Add photo","aria-label":"Add photo",children:"Add media"})]}),e.jsxs("div",{className:U.composeActions,children:[e.jsx(sn,{used:_t.text.length,max:300}),e.jsx("button",{type:"button",className:U.composeAddThread,onClick:function(){gt(e=>[...e,{text:"",images:[],imageAlts:[]}]),bt(e=>e+1)},disabled:vt,title:"Add to thread","aria-label":"Add to thread",children:"+"})]})]}),wt&&e.jsx("p",{className:U.composeError,children:wt})]}):e.jsxs("p",{className:U.composeSignIn,children:[e.jsx("button",{type:"button",className:U.composeSignInLink,onClick:()=>{ga(),te()},children:"Log in"})," to post."]})]})})]}),Wt&&Dn&&e.jsx(_e,{onClose:()=>Dt(!1),showToast:Dn.showToast}),Tt&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:U.searchOverlayBackdrop,onClick:()=>Rt(!1),"aria-hidden":!0}),e.jsx("div",{className:U.aboutOverlay,role:"dialog","aria-label":"About ArtSky",onClick:()=>Rt(!1),children:e.jsxs("div",{className:U.aboutCard,onClick:e=>e.stopPropagation(),children:[e.jsx("h2",{className:U.aboutTitle,children:"ArtSky"}),e.jsx("p",{className:U.aboutIntro,children:"A Bluesky client focused on art."}),e.jsx("h3",{className:U.aboutSubtitle,children:"Keyboard shortcuts"}),e.jsxs("dl",{className:U.aboutShortcuts,children:[e.jsx("dt",{children:"W / ↑"}),e.jsx("dd",{children:"Move up"}),e.jsx("dt",{children:"A / ←"}),e.jsx("dd",{children:"Move left"}),e.jsx("dt",{children:"S / ↓"}),e.jsx("dd",{children:"Move down"}),e.jsx("dt",{children:"D / →"}),e.jsx("dd",{children:"Move right"}),e.jsx("dt",{children:"Q"}),e.jsx("dd",{children:"Quit / close window"}),e.jsx("dt",{children:"E"}),e.jsx("dd",{children:"Enter post"}),e.jsx("dt",{children:"R"}),e.jsx("dd",{children:"Reply to post"}),e.jsx("dt",{children:"T"}),e.jsx("dd",{children:"Toggle text view"}),e.jsx("dt",{children:"F"}),e.jsx("dd",{children:"Like / unlike"}),e.jsx("dt",{children:"C"}),e.jsx("dd",{children:"Collect post"}),e.jsx("dt",{children:"B"}),e.jsx("dd",{children:"Block author (feed)"}),e.jsx("dt",{children:"4"}),e.jsx("dd",{children:"Follow author"}),e.jsx("dt",{children:"Escape"}),e.jsx("dd",{children:"Escape all windows"}),e.jsx("dt",{children:"1 / 2 / 3"}),e.jsx("dd",{children:"1, 2, or 3 column view"})]}),e.jsx("button",{type:"button",className:U.aboutClose,onClick:()=>Rt(!1),"aria-label":"Close",children:"Close"})]})})]})]}),Dn?.toastMessage&&e.jsx("div",{className:"app-toast float-btn",role:"status","aria-live":"polite",children:Dn.toastMessage})]})})})}export{Qt as C,hn as F,Wn as L,sn as a,Z as u};
