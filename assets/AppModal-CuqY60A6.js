import{u as e,aC as t,C as n,j as o}from"./index-DO5u49Z-.js";import{r as a,a as r}from"./react-vendor-rw3WIpbI.js";import{M as l}from"./ModalTopBarSlotContext-BCMHq62N.js";import{M as s}from"./ModalScrollContext-CCpHgC4Z.js";import{u as i,P as c}from"./usePullToRefresh-QiYvLiof.js";const d={overlay:"_overlay_hudf3_1",overlayFlushTop:"_overlayFlushTop_hudf3_22",modalFloatingBack:"_modalFloatingBack_hudf3_27",modalFloatingBackScrollHidden:"_modalFloatingBackScrollHidden_hudf3_62",overlayExpanded:"_overlayExpanded_hudf3_69",pane:"_pane_hudf3_78",paneCompact:"_paneCompact_hudf3_92",paneSwipeReturning:"_paneSwipeReturning_hudf3_98",paneExpanded:"_paneExpanded_hudf3_103",modalTopBar:"_modalTopBar_hudf3_113",scroll:"_scroll_hudf3_117",scrollWithFloatingBack:"_scrollWithFloatingBack_hudf3_129",pullRefreshHeader:"_pullRefreshHeader_hudf3_134",pullRefreshSpinner:"_pullRefreshSpinner_hudf3_144",pullRefreshContent:"_pullRefreshContent_hudf3_159",modalBetaAlert:"_modalBetaAlert_hudf3_164",modalTopBarTransparent:"_modalTopBarTransparent_hudf3_193",scrollWithTransparentBar:"_scrollWithTransparentBar_hudf3_215",modalTopBarActionsBelow:"_modalTopBarActionsBelow_hudf3_220",modalTopBarLeft:"_modalTopBarLeft_hudf3_220",modalTopBarSlot:"_modalTopBarSlot_hudf3_228",modalTopBarRight:"_modalTopBarRight_hudf3_232"};function u(e){if("undefined"==typeof window)return()=>{};const t=window.matchMedia("(max-width: 767px)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}function h(){return"undefined"!=typeof window&&window.innerWidth<768}function p({ariaLabel:p,children:f,onClose:m,onBack:_,canGoBack:T,transparentTopBar:v=!1,hideTopBar:g=!1,compact:B=!1,onSwipeLeft:R,onPullToRefresh:S}){const w=a.useRef(null),x=a.useRef(null),{modalScrollHidden:E,setModalScrollHidden:k}=e(),$=a.useRef(0),y=a.useRef(null),C=a.useSyncExternalStore(u,h,()=>!1),j=i({scrollRef:x,touchTargetRef:x,onRefresh:S??(()=>{}),enabled:!!S&&!C}),[b,M]=a.useState(null),[L,N]=a.useState(null),{expanded:F,setExpanded:D}=t(),A=n(),H=function({enabled:e,onSwipeRight:t,onSwipeLeft:n}){const o=a.useRef(0),r=a.useRef(0),l=a.useRef(!1),[s,i]=a.useState(0),[c,d]=a.useState(!1);return{onTouchStart:a.useCallback(t=>{e&&1===t.touches.length&&(o.current=t.touches[0].clientX,r.current=t.touches[0].clientY,l.current=!1)},[e]),onTouchMove:a.useCallback(t=>{if(!e||1!==t.touches.length)return;const n=t.touches[0].clientX-o.current,a=t.touches[0].clientY-r.current;if(!l.current){if(!(Math.abs(n)>28&&Math.abs(n)>2*Math.abs(a)))return;l.current=!0}t.preventDefault();const s=Math.max(-140,Math.min(140,n));i(s)},[e]),onTouchEnd:a.useCallback(a=>{if(!e||1!==a.changedTouches.length)return i(0),void d(!1);const r=a.changedTouches[0].clientX-o.current;l.current&&Math.abs(r)>80&&(r>0||r<0&&n)?r>0?t():n&&n():(d(!0),setTimeout(()=>d(!1),220)),l.current=!1,i(0)},[e,t,n]),translateX:s,isReturning:c,style:0!==s?{transform:`translateX(${s}px)`}:void 0}}({enabled:C,onSwipeRight:()=>T?_():m(),onSwipeLeft:R});a.useEffect(()=>(A?.lockScroll(),()=>A?.unlockScroll()),[A]),a.useEffect(()=>{const e=w.current,t=x.current;if(!e||!t)return;const n=n=>{const o=n.target;if(!e.contains(o))return n.preventDefault(),void(t.scrollTop+=n.deltaY);t.contains(o)||(n.preventDefault(),t.scrollTop+=n.deltaY)};return window.addEventListener("wheel",n,{passive:!1,capture:!0}),()=>window.removeEventListener("wheel",n,{capture:!0})},[]),a.useEffect(()=>{const e=x.current;if(!e||!C)return;$.current=e.scrollTop;function t(){const e=x.current;if(!e)return;const t=e.scrollTop,n=t-$.current;n>8?k(!0):n<-8&&k(!1),$.current=t,y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{y.current=null,k(!1)},350)}return e.addEventListener("scroll",t,{passive:!0}),()=>{e.removeEventListener("scroll",t),y.current&&clearTimeout(y.current)}},[C,k]),a.useEffect(()=>{C&&D(!0)},[C,D]),a.useEffect(()=>{const e=e=>{const t=e.target;if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"SELECT"!==t.tagName&&!t.isContentEditable)return"Escape"===e.key?(e.preventDefault(),e.stopImmediatePropagation(),void m()):void("q"===e.key.toLowerCase()&&(e.preventDefault(),e.stopImmediatePropagation(),_()));"Escape"===e.key&&(e.preventDefault(),t.blur())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[m,_]);const P=o.jsx(l.Provider,{value:{centerSlot:b,rightSlot:L,isMobile:C},children:o.jsxs("div",{ref:w,className:`${d.overlay}${v?` ${d.overlayFlushTop}`:""}${F?` ${d.overlayExpanded}`:""}`,onClick:function(e){e.target===w.current&&m()},role:"dialog","aria-modal":"true","aria-label":p,children:[o.jsx("button",{type:"button",className:`${d.modalFloatingBack}${E?` ${d.modalFloatingBackScrollHidden}`:""}`,onClick:T?_:m,"aria-label":T?"Back":"Close",title:T?"Back":"Close",children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),o.jsxs("div",{className:`${d.pane}${H.isReturning?` ${d.paneSwipeReturning}`:""}${v?` ${d.paneNoRightBorder}`:""}${B?` ${d.paneCompact}`:""}${F?` ${d.paneExpanded}`:""}`,style:H.style,onTouchStart:H.onTouchStart,onTouchMove:H.onTouchMove,onTouchEnd:H.onTouchEnd,onClick:e=>e.stopPropagation(),children:[!g&&o.jsxs("div",{className:`${d.modalTopBar} ${v?d.modalTopBarTransparent:""} ${d.modalTopBarActionsBelow}`,children:[o.jsx("div",{className:d.modalTopBarLeft,"aria-hidden":"true"}),o.jsx("div",{ref:M,className:d.modalTopBarSlot}),o.jsx("div",{ref:N,className:d.modalTopBarRight})]}),o.jsxs("div",{ref:x,"data-modal-scroll":!0,className:`${d.scroll} ${v?d.scrollWithTransparentBar:""} ${d.scrollWithFloatingBack}`,onTouchStart:j.onTouchStart,onTouchMove:j.onTouchMove,onTouchEnd:j.onTouchEnd,children:[S&&o.jsx("div",{className:d.pullRefreshHeader,style:{height:j.pullDistance>0||j.isRefreshing?c:0},"aria-hidden":0===j.pullDistance&&!j.isRefreshing,"aria-live":"polite","aria-label":j.isRefreshing?"Refreshing":void 0,children:(j.pullDistance>0||j.isRefreshing)&&o.jsx("div",{className:d.pullRefreshSpinner})}),o.jsx("div",{className:S?d.pullRefreshContent:void 0,style:S?{transform:`translateY(${j.pullDistance}px)`}:void 0,children:o.jsx(s,{scrollRef:x,children:f})})]})]})]})});return r.createPortal(P,document.body)}export{p as A,d as s};
