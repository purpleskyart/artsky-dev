import{k as s,u as e,j as t,b as a}from"./index-B6Oq1pSb.js";import{b as o,L as l}from"./react-vendor-DGaPsC2e.js";import{A as n}from"./AppModal-B5Npsep4.js";import{b as i,e as c}from"./artboards-DNvSVVrd.js";import{p as r}from"./artboardsPds-DWUixJ9h.js";import{u as d}from"./useListKeyboardNav-3q-0e0hq.js";import"./Layout-DN75vOWm.js";import"./atproto-3-1TCh3S.js";import"./ModalTopBarSlotContext-XWKZv5-E.js";import"./ModalScrollContext-B7n00fEw.js";import"./usePullToRefresh-DVlCPYCP.js";import"./Icons-Cxp2k-Gy.js";import"./PostText-CvbwNCN2.js";const m="_wrap_5pkk3_1",h="_count_5pkk3_8",u="_empty_5pkk3_15",p="_grid_5pkk3_23",_="_card_5pkk3_31",x="_cardFocused_5pkk3_42",k="_link_5pkk3_48",j="_handle_5pkk3_57",f="_text_5pkk3_58",b="_mediaWrap_5pkk3_72",N="_thumbsGrid_5pkk3_79",g="_thumb_5pkk3_79",v="_thumbSpan_5pkk3_96",y="_placeholder_5pkk3_109",C="_meta_5pkk3_120",R="_remove_5pkk3_146";function $({id:n,inModal:$=!1,onRegisterRefresh:M}){const{session:S}=s(),{openPostModal:w}=e(),[,B]=o.useState(0),[A,I]=o.useState(0),P=o.useRef(null),z=n?i(n):void 0,L=z?.posts??[];if(o.useEffect(()=>{I(s=>L.length?Math.min(s,L.length-1):0)},[L.length]),o.useEffect(()=>{M?.(()=>B(s=>s+1))},[M]),o.useEffect(()=>{if(!$||!P.current||A<0)return;const s=P.current.querySelector(`[data-collection-post-index="${A}"]`);s&&s.scrollIntoView({block:"nearest",behavior:"smooth"})},[$,A]),d({enabled:$&&L.length>0,itemCount:L.length,focusedIndex:A,setFocusedIndex:I,columns:2,onActivate:s=>{const e=L[s];e&&w(e.uri)},useCapture:!0}),!n||!z)return t.jsx("div",{className:m,children:t.jsx("p",{className:u,children:"Collection not found."})});const T=z.id;return t.jsxs("div",{className:m,children:[t.jsxs("p",{className:h,children:[L.length," post",1!==L.length?"s":""]}),0===L.length?t.jsx("p",{className:u,children:"No posts saved yet. Add posts from the feed."}):t.jsx("div",{ref:P,className:p,children:L.map((s,e)=>t.jsxs("div",{className:`${_} ${$&&e===A?x:""}`,"data-collection-post-index":$?e:void 0,children:[$?t.jsxs("button",{type:"button",className:k,onClick:()=>w(s.uri),children:[t.jsx("div",{className:b,children:s.thumbs&&s.thumbs.length>0?t.jsx("div",{className:N,children:s.thumbs.map((e,a)=>t.jsx("img",{src:e,alt:"",className:1===s.thumbs.length?`${g} ${v}`:g,loading:"lazy"},a))}):s.thumb?t.jsx("img",{src:s.thumb,alt:"",className:g,loading:"lazy"}):t.jsx("div",{className:y,children:"ðŸ“Œ"})}),t.jsxs("div",{className:C,children:[t.jsxs("span",{className:j,children:["@",s.authorHandle??"unknown"]}),s.text?t.jsxs("p",{className:f,children:[s.text.slice(0,80),s.text.length>80?"â€¦":""]}):null]})]}):t.jsxs(l,{to:`/post/${encodeURIComponent(s.uri)}`,className:k,children:[t.jsx("div",{className:b,children:s.thumbs&&s.thumbs.length>0?t.jsx("div",{className:N,children:s.thumbs.map((e,a)=>t.jsx("img",{src:e,alt:"",className:1===s.thumbs.length?`${g} ${v}`:g,loading:"lazy"},a))}):s.thumb?t.jsx("img",{src:s.thumb,alt:"",className:g,loading:"lazy"}):t.jsx("div",{className:y,children:"ðŸ“Œ"})}),t.jsxs("div",{className:C,children:[t.jsxs("span",{className:j,children:["@",s.authorHandle??"unknown"]}),s.text?t.jsxs("p",{className:f,children:[s.text.slice(0,80),s.text.length>80?"â€¦":""]}):null]})]}),t.jsx("button",{type:"button",className:R,onClick:()=>async function(s){if(confirm("Remove this post from the collection?")&&(c(T,s),B(s=>s+1),S?.did)){const s=i(T);if(s)try{await r(a,S.did,s)}catch{}}}(s.uri),title:"Remove from collection",children:"Remove"})]},s.uri))})]})}function M({id:s,onClose:e,onBack:a,canGoBack:l}){const[i,c]=o.useState(null);return t.jsx(n,{ariaLabel:"Collection",onClose:e,onBack:a,canGoBack:l,onPullToRefresh:i?()=>i():void 0,children:t.jsx($,{id:s,inModal:!0,onRegisterRefresh:s=>c(()=>s)})})}export{M as default};
