import{r as e}from"./react-vendor-rw3WIpbI.js";const t=56;function r(e){return e?.current?e.current.scrollTop:"undefined"==typeof window?0:window.scrollY??document.documentElement.scrollTop}function n({scrollRef:t,touchTargetRef:n,onRefresh:u,enabled:c=!0,maxTouchStartY:o}){const s=e.useRef(0),i=e.useRef(0),l=e.useRef(!1),a=e.useRef(0),[f,h]=e.useState(0),[v,d]=e.useState(!1),m=e.useRef(u);m.current=u;const p=e.useCallback(async()=>{d(!0),h(56);try{await Promise.resolve(m.current())}finally{d(!1),h(0)}},[]),R=e.useCallback(e=>{if(!c||1!==e.touches.length)return;l.current=!1,h(0);const n=e.touches[0].clientY;null!=o&&n>o||(s.current=n,i.current=r(t))},[c,t,o]),g=e.useCallback(e=>{if(!c||1!==e.touches.length)return;const n=r(t),u=e.touches[0].clientY-s.current;if(!l.current){if(!(n<=2&&u>8))return;l.current=!0}if(l.current&&n<=2&&u>0){e.preventDefault();const t=Math.min(90,u);a.current=t,h(t)}},[c,t]),T=e.useCallback(e=>{if(!c||1!==e.changedTouches.length)return l.current=!1,void h(0);if(l.current){a.current>=58&&!v?p():(a.current=0,h(0)),l.current=!1}},[c,v,p]);return e.useEffect(()=>{const e=n?.current??t?.current;if(!c||!e)return;const u=e=>{1===e.touches.length&&(s.current=e.touches[0].clientY)},i=e=>{if(1!==e.touches.length)return;const n=r(t),u=e.touches[0].clientY-s.current;if(!(null!=o&&s.current>o)){if(!l.current){if(!(n<=2&&u>8))return;l.current=!0}if(l.current&&n<=2&&u>0){e.preventDefault();const t=Math.min(90,u);a.current=t,h(t)}}};return e.addEventListener("touchstart",u,{passive:!0}),e.addEventListener("touchmove",i,{passive:!1}),()=>{e.removeEventListener("touchstart",u),e.removeEventListener("touchmove",i)}},[c,t,n,o]),{onTouchStart:R,onTouchMove:g,onTouchEnd:T,pullDistance:f,isRefreshing:v}}export{t as P,n as u};
