import{b as e}from"./react-vendor-DGaPsC2e.js";const t=56;function r(e){return e?.current?e.current.scrollTop:"undefined"==typeof window?0:window.scrollY??document.documentElement.scrollTop}function n({scrollRef:t,touchTargetRef:n,onRefresh:c,enabled:u=!0,maxTouchStartY:s}){const o=e.useRef(0),a=e.useRef(0),i=e.useRef(0),l=e.useRef(!1),h=e.useRef(0),[f,v]=e.useState(0),[d,m]=e.useState(!1),b=e.useRef(c);b.current=c;const p=e.useCallback(async()=>{m(!0),v(56);try{await Promise.resolve(b.current())}finally{m(!1),v(0)}},[]),R=e.useCallback(e=>{if(!u||1!==e.touches.length)return;l.current=!1,v(0);const n=e.touches[0].clientX,c=e.touches[0].clientY;null!=s&&c>s||(o.current=n,a.current=c,i.current=r(t))},[u,t,s]),g=e.useCallback(e=>{if(!u||1!==e.touches.length)return;const n=r(t),c=e.touches[0].clientX-o.current,s=e.touches[0].clientY-a.current;if(!(Math.abs(c)>2*Math.abs(s))){if(!l.current){if(!(n<=2&&s>8))return;l.current=!0}if(l.current&&n<=2&&s>0){e.preventDefault();const t=Math.min(90,s);h.current=t,v(t)}}},[u,t]),T=e.useCallback(e=>{if(!u||1!==e.changedTouches.length)return l.current=!1,void v(0);if(l.current){h.current>=58&&!d?p():(h.current=0,v(0)),l.current=!1}},[u,d,p]);return e.useEffect(()=>{const e=n?.current??t?.current;if(!u||!e)return;const c=e=>{1===e.touches.length&&(o.current=e.touches[0].clientX,a.current=e.touches[0].clientY)},i=e=>{if(1!==e.touches.length)return;const n=r(t),c=e.touches[0].clientX-o.current,u=e.touches[0].clientY-a.current;if(!(Math.abs(c)>2*Math.abs(u)||null!=s&&a.current>s)){if(!l.current){if(!(n<=2&&u>8))return;l.current=!0}if(l.current&&n<=2&&u>0){e.preventDefault();const t=Math.min(90,u);h.current=t,v(t)}}};return e.addEventListener("touchstart",c,{passive:!0}),e.addEventListener("touchmove",i,{passive:!1}),()=>{e.removeEventListener("touchstart",c),e.removeEventListener("touchmove",i)}},[u,t,n,s]),{onTouchStart:R,onTouchMove:g,onTouchEnd:T,pullDistance:f,isRefreshing:d}}export{t as P,n as u};
