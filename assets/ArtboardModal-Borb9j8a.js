import{k as s,u as e,j as t,b as a}from"./index-BXBIaIN_.js";import{b as o,L as l}from"./react-vendor-DGaPsC2e.js";import{A as n}from"./AppModal-3LvZLydf.js";import{b as i,e as c}from"./artboards-DNvSVVrd.js";import{p as r}from"./artboardsPds-DWUixJ9h.js";import{u as d}from"./useListKeyboardNav-3q-0e0hq.js";import"./Layout-DUDhZOFY.js";import"./atproto-3-1TCh3S.js";import"./ModalTopBarSlotContext-XWKZv5-E.js";import"./ModalScrollContext-CNWnUaKs.js";import"./usePullToRefresh-DVlCPYCP.js";import"./Icons-psAHoCnZ.js";import"./PostText-CYuGKBer.js";const m="_wrap_5pkk3_1",h="_count_5pkk3_8",u="_empty_5pkk3_15",p="_grid_5pkk3_23",_="_card_5pkk3_31",x="_cardFocused_5pkk3_42",k="_link_5pkk3_48",j="_handle_5pkk3_57",f="_text_5pkk3_58",b="_mediaWrap_5pkk3_72",N="_thumbsGrid_5pkk3_79",g="_thumb_5pkk3_79",v="_thumbSpan_5pkk3_96",y="_placeholder_5pkk3_109",C="_meta_5pkk3_120",R="_remove_5pkk3_146";function $({id:n,inModal:$=!1,onRegisterRefresh:M}){const{session:S}=s(),{openPostModal:w}=e(),[,z]=o.useState(0),[A,B]=o.useState(0),I=o.useRef(null),P=n?i(n):void 0,E=P?.posts??[];if(o.useEffect(()=>{B(s=>E.length?Math.min(s,E.length-1):0)},[E.length]),o.useEffect(()=>{M?.(()=>z(s=>s+1))},[M]),o.useEffect(()=>{if(!$||!I.current||A<0)return;const s=I.current.querySelector(`[data-collection-post-index="${A}"]`);s&&s.scrollIntoView({block:"nearest",behavior:"smooth"})},[$,A]),d({enabled:$&&E.length>0,itemCount:E.length,focusedIndex:A,setFocusedIndex:B,columns:2,onActivate:s=>{const e=E[s];e&&w(e.uri)},useCapture:!0}),!n||!P)return t.jsx("div",{className:m,children:t.jsx("p",{className:u,children:"Collection not found."})});const L=P.id;return t.jsxs("div",{className:m,children:[t.jsxs("p",{className:h,children:[E.length," post",1!==E.length?"s":""]}),0===E.length?t.jsx("p",{className:u,children:"No posts saved yet. Add posts from the feed."}):t.jsx("div",{ref:I,className:p,children:E.map((s,e)=>t.jsxs("div",{className:`${_} ${$&&e===A?x:""}`,"data-collection-post-index":$?e:void 0,children:[$?t.jsxs("button",{type:"button",className:k,onClick:()=>w(s.uri),children:[t.jsx("div",{className:b,children:s.thumbs&&s.thumbs.length>0?t.jsx("div",{className:N,children:s.thumbs.map((e,a)=>t.jsx("img",{src:e,alt:"",className:1===s.thumbs.length?`${g} ${v}`:g,loading:"lazy"},a))}):s.thumb?t.jsx("img",{src:s.thumb,alt:"",className:g,loading:"lazy"}):t.jsx("div",{className:y,children:"ðŸ“Œ"})}),t.jsxs("div",{className:C,children:[t.jsxs("span",{className:j,children:["@",s.authorHandle??"unknown"]}),s.text?t.jsxs("p",{className:f,children:[s.text.slice(0,80),s.text.length>80?"â€¦":""]}):null]})]}):t.jsxs(l,{to:`/post/${encodeURIComponent(s.uri)}`,className:k,children:[t.jsx("div",{className:b,children:s.thumbs&&s.thumbs.length>0?t.jsx("div",{className:N,children:s.thumbs.map((e,a)=>t.jsx("img",{src:e,alt:"",className:1===s.thumbs.length?`${g} ${v}`:g,loading:"lazy"},a))}):s.thumb?t.jsx("img",{src:s.thumb,alt:"",className:g,loading:"lazy"}):t.jsx("div",{className:y,children:"ðŸ“Œ"})}),t.jsxs("div",{className:C,children:[t.jsxs("span",{className:j,children:["@",s.authorHandle??"unknown"]}),s.text?t.jsxs("p",{className:f,children:[s.text.slice(0,80),s.text.length>80?"â€¦":""]}):null]})]}),t.jsx("button",{type:"button",className:R,onClick:()=>async function(s){if(confirm("Remove this post from the collection?")&&(c(L,s),z(s=>s+1),S?.did)){const s=i(L);if(s)try{await r(a,S.did,s)}catch{}}}(s.uri),title:"Remove from collection",children:"Remove"})]},s.uri))})]})}function M({id:s,onClose:e,onBack:a,canGoBack:l}){const[i,c]=o.useState(null);return t.jsx(n,{ariaLabel:"Collection",onClose:e,onBack:a,canGoBack:l,onPullToRefresh:i?()=>i():void 0,children:t.jsx($,{id:s,inModal:!0,onRegisterRefresh:s=>c(()=>s)})})}export{M as default};
