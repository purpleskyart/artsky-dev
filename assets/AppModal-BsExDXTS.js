import{u as e,aC as o,C as t,j as n}from"./index-DlaOPLEe.js";import{b as a,h as r}from"./react-vendor-DGaPsC2e.js";import{M as l}from"./ModalTopBarSlotContext-XWKZv5-E.js";import{M as s}from"./ModalScrollContext-CSfVhxQU.js";import{u as i,P as c}from"./usePullToRefresh-DVlCPYCP.js";const d={overlay:"_overlay_13oop_1",overlayFlushTop:"_overlayFlushTop_13oop_22",modalFloatingBack:"_modalFloatingBack_13oop_27",modalFloatingBackScrollHidden:"_modalFloatingBackScrollHidden_13oop_70",overlayExpanded:"_overlayExpanded_13oop_77",pane:"_pane_13oop_86",paneCompact:"_paneCompact_13oop_100",paneSwipeReturning:"_paneSwipeReturning_13oop_106",paneExpanded:"_paneExpanded_13oop_111",modalTopBar:"_modalTopBar_13oop_121",scroll:"_scroll_13oop_125",scrollWithFloatingBack:"_scrollWithFloatingBack_13oop_137",pullRefreshHeader:"_pullRefreshHeader_13oop_149",pullRefreshSpinner:"_pullRefreshSpinner_13oop_159",pullRefreshContent:"_pullRefreshContent_13oop_174",modalBetaAlert:"_modalBetaAlert_13oop_179",modalTopBarTransparent:"_modalTopBarTransparent_13oop_208",scrollWithTransparentBar:"_scrollWithTransparentBar_13oop_230",modalTopBarActionsBelow:"_modalTopBarActionsBelow_13oop_235",modalTopBarLeft:"_modalTopBarLeft_13oop_235",modalTopBarSlot:"_modalTopBarSlot_13oop_243",modalTopBarRight:"_modalTopBarRight_13oop_247"};function u(e){if("undefined"==typeof window)return()=>{};const o=window.matchMedia("(max-width: 767px)");return o.addEventListener("change",e),()=>o.removeEventListener("change",e)}function p(){return"undefined"!=typeof window&&window.innerWidth<768}function h({ariaLabel:h,children:f,onClose:m,onBack:_,canGoBack:T,transparentTopBar:v=!1,hideTopBar:g=!1,compact:B=!1,onSwipeLeft:R,onPullToRefresh:S}){const w=a.useRef(null),x=a.useRef(null),{modalScrollHidden:E,setModalScrollHidden:k}=e(),$=a.useRef(0),y=a.useRef(null),C=a.useSyncExternalStore(u,p,()=>!1),j=i({scrollRef:x,touchTargetRef:x,onRefresh:S??(()=>{}),enabled:!!S&&!C}),[b,M]=a.useState(null),[L,N]=a.useState(null),{expanded:F,setExpanded:D}=o(),A=t(),H=function({enabled:e,onSwipeRight:o,onSwipeLeft:t}){const n=a.useRef(0),r=a.useRef(0),l=a.useRef(!1),[s,i]=a.useState(0),[c,d]=a.useState(!1);return{onTouchStart:a.useCallback(o=>{e&&1===o.touches.length&&(n.current=o.touches[0].clientX,r.current=o.touches[0].clientY,l.current=!1)},[e]),onTouchMove:a.useCallback(o=>{if(!e||1!==o.touches.length)return;const t=o.touches[0].clientX-n.current,a=o.touches[0].clientY-r.current;if(!l.current){if(!(Math.abs(t)>28&&Math.abs(t)>2*Math.abs(a)))return;l.current=!0}o.preventDefault();const s=Math.max(-140,Math.min(140,t));i(s)},[e]),onTouchEnd:a.useCallback(a=>{if(!e||1!==a.changedTouches.length)return i(0),void d(!1);const r=a.changedTouches[0].clientX-n.current;l.current&&Math.abs(r)>80&&(r>0||r<0&&t)?r>0?o():t&&t():(d(!0),setTimeout(()=>d(!1),220)),l.current=!1,i(0)},[e,o,t]),translateX:s,isReturning:c,style:0!==s?{transform:`translateX(${s}px)`}:void 0}}({enabled:C,onSwipeRight:()=>T?_():m(),onSwipeLeft:R});a.useEffect(()=>(A?.lockScroll(),()=>A?.unlockScroll()),[A]),a.useEffect(()=>{const e=w.current,o=x.current;if(!e||!o)return;const t=t=>{const n=t.target;if(!e.contains(n))return t.preventDefault(),void(o.scrollTop+=t.deltaY);o.contains(n)||(t.preventDefault(),o.scrollTop+=t.deltaY)};return window.addEventListener("wheel",t,{passive:!1,capture:!0}),()=>window.removeEventListener("wheel",t,{capture:!0})},[]),a.useEffect(()=>{const e=x.current;if(!e||!C)return;$.current=e.scrollTop;function o(){const e=x.current;if(!e)return;const o=e.scrollTop,t=o-$.current;t>8?k(!0):t<-8&&k(!1),$.current=o,y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{y.current=null,k(!1)},350)}return e.addEventListener("scroll",o,{passive:!0}),()=>{e.removeEventListener("scroll",o),y.current&&clearTimeout(y.current)}},[C,k]),a.useEffect(()=>{C&&D(!0)},[C,D]),a.useEffect(()=>{const e=e=>{const o=e.target;if("INPUT"!==o.tagName&&"TEXTAREA"!==o.tagName&&"SELECT"!==o.tagName&&!o.isContentEditable)return"Escape"===e.key?(e.preventDefault(),e.stopImmediatePropagation(),void m()):void("q"===e.key.toLowerCase()&&(e.preventDefault(),e.stopImmediatePropagation(),_()));"Escape"===e.key&&(e.preventDefault(),o.blur())};return window.addEventListener("keydown",e,!0),()=>window.removeEventListener("keydown",e,!0)},[m,_]);const P=n.jsx(l.Provider,{value:{centerSlot:b,rightSlot:L,isMobile:C},children:n.jsx("div",{ref:w,className:`${d.overlay}${v?` ${d.overlayFlushTop}`:""}${F?` ${d.overlayExpanded}`:""}`,onClick:function(e){e.target===w.current&&m()},role:"dialog","aria-modal":"true","aria-label":h,children:n.jsxs("div",{className:`${d.pane}${H.isReturning?` ${d.paneSwipeReturning}`:""}${v?` ${d.paneNoRightBorder}`:""}${B?` ${d.paneCompact}`:""}${F?` ${d.paneExpanded}`:""}`,style:H.style,onTouchStart:H.onTouchStart,onTouchMove:H.onTouchMove,onTouchEnd:H.onTouchEnd,onClick:e=>e.stopPropagation(),children:[n.jsx("button",{type:"button",className:`${d.modalFloatingBack}${E?` ${d.modalFloatingBackScrollHidden}`:""}`,onClick:T?_:m,"aria-label":T?"Back":"Close",title:T?"Back":"Close",children:n.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":!0,children:n.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),!g&&n.jsxs("div",{className:`${d.modalTopBar} ${v?d.modalTopBarTransparent:""} ${d.modalTopBarActionsBelow}`,children:[n.jsx("div",{className:d.modalTopBarLeft,"aria-hidden":"true"}),n.jsx("div",{ref:M,className:d.modalTopBarSlot}),n.jsx("div",{ref:N,className:d.modalTopBarRight})]}),n.jsxs("div",{ref:x,"data-modal-scroll":!0,className:`${d.scroll} ${v?d.scrollWithTransparentBar:""} ${d.scrollWithFloatingBack}`,onTouchStart:j.onTouchStart,onTouchMove:j.onTouchMove,onTouchEnd:j.onTouchEnd,children:[S&&n.jsx("div",{className:d.pullRefreshHeader,style:{height:j.pullDistance>0||j.isRefreshing?c:0},"aria-hidden":0===j.pullDistance&&!j.isRefreshing,"aria-live":"polite","aria-label":j.isRefreshing?"Refreshing":void 0,children:(j.pullDistance>0||j.isRefreshing)&&n.jsx("div",{className:d.pullRefreshSpinner})}),n.jsx("div",{className:S?d.pullRefreshContent:void 0,style:S?{transform:`translateY(${j.pullDistance}px)`}:void 0,children:n.jsx(s,{scrollRef:x,children:f})})]})]})})});return r.createPortal(P,document.body)}export{h as A,d as s};
