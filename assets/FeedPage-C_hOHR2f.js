import{u as e,g as t,a as n,b as s,c as r,d as o,j as a,e as i,f as l,i as c,h as d,k as u,l as f,m as p,n as m,o as h,p as g,q as y,r as x,s as w,t as _,v as b,w as v,x as E,y as j,z as M}from"./index-CxrS-4Im.js";import{b as N,h as S,u as k,d as T,i as I}from"./react-vendor-DGaPsC2e.js";import{u as A,F as R,L as C}from"./Layout-D_5WMlYL.js";import{u as O}from"./usePullToRefresh-DVlCPYCP.js";import{P as F}from"./PostCard-DmRQ8t92.js";import{setInitialPostForUri as P}from"./postCache-CTqU0alO.js";import{s as L}from"./FeedPage.module-DHdPJV-V.js";import"./atproto-3-1TCh3S.js";import"./Icons-BJ971Mz8.js";import"./PostText-DYSApYWK.js";import"./PostActionsMenu-yyFn4Qo4.js";import"./artboards-DNvSVVrd.js";import"./artboardsPds-DWUixJ9h.js";function U(e,t){let n;return function(...s){void 0!==n&&clearTimeout(n),n=setTimeout(()=>{n=void 0,e(...s)},t)}}function D(e,t=150){const n=function(e=150){const[t,n]=N.useState(()=>"undefined"!=typeof window?window.innerWidth:0);return N.useEffect(()=>{const t=U(()=>{n(window.innerWidth)},e);return n(window.innerWidth),window.addEventListener("resize",t,{passive:!0}),()=>{window.removeEventListener("resize",t)}},[e]),t}(t);return N.useMemo(()=>{const t="1"===e?1:"2"===e?2:3;return Math.min(3,Math.max(1,t))},[e,n])}const H="artsky-recommendations-shown";function B(){try{const e=localStorage.getItem(H);if(!e)return{};const t=JSON.parse(e);return"object"==typeof t&&null!==t?t:{}}catch{return{}}}const Y="_wrap_ljlgs_1",$="_subtext_ljlgs_10",z="_sortRow_ljlgs_18",q="_sortLabel_ljlgs_26",K="_sortSelect_ljlgs_31",W="_loading_ljlgs_46",G="_empty_ljlgs_47",V="_list_ljlgs_54",J="_item_ljlgs_65",X="_profileBtn_ljlgs_72",Q="_avatar_ljlgs_97",Z="_avatarPlaceholder_ljlgs_106",ee="_info_ljlgs_121",te="_handle_ljlgs_127",ne="_reason_ljlgs_135",se="_actions_ljlgs_140",re="_infoBtn_ljlgs_150",oe="_infoIcon_ljlgs_174",ae="_followBtn_ljlgs_179",ie="_dismissBtn_ljlgs_199",le="_detailBackdrop_ljlgs_226",ce="_detailPanel_ljlgs_237",de="_detailHeader_ljlgs_250",ue="_detailTitle_ljlgs_258",fe="_detailClose_ljlgs_265",pe="_detailBody_ljlgs_284",me="_detailSummary_ljlgs_289",he="_detailList_ljlgs_295",ge="_detailListItem_ljlgs_304",ye="_detailProfileBtn_ljlgs_308",xe="_detailAvatar_ljlgs_332",we="_detailAvatarPlaceholder_ljlgs_340",_e="_detailProfileInfo_ljlgs_354",be="_detailDisplayName_ljlgs_360",ve="_detailHandle_ljlgs_368",Ee="_detailLoading_ljlgs_376";function je(){const{openProfileModal:i}=e(),[l,c]=N.useState([]),[d,u]=N.useState(!1),[f,p]=N.useState(null),[m,h]=N.useState(()=>new Set),[g,y]=N.useState("count"),[x,w]=N.useState(null),[_,b]=N.useState(null),[v,E]=N.useState(!1),j=N.useMemo(()=>l,[l]),M=N.useCallback(async()=>{const e=t(),o=e?.did;if(o){u(!0);try{const e="mutuals"===g?await n(s,o,{maxSuggestions:20}):await r(s,o,{maxSuggestions:20}),t=B(),a=Date.now()-6048e5,i=e.filter(e=>!m.has(e.did)&&(!t[e.did]||t[e.did]<a)).slice(0,8);c(i)}catch{c([])}finally{u(!1)}}},[m,g]);N.useEffect(()=>{M()},[M]);const k=N.useCallback(async e=>{w(e.did),b(null),E(!0);try{const n=t(),r=n?.did;if(!r)return;const a=await o(s,r,e.did,{source:"mutuals"===g?"mutuals":"peopleYouFollow"});b(a)}catch{b({count:0,followedBy:[]})}finally{E(!1)}},[g]),T=N.useCallback(async(e,t)=>{p(e);try{await s.follow(e),c(t=>t.filter(t=>t.did!==e))}catch{}finally{p(null)}},[]),I=N.useCallback(e=>{!function(e){if(0===e.length)return;const t=Date.now(),n={...B()};for(const o of e)n[o]=t;const s=Object.entries(n),r=s.length<=500?s:s.sort((e,t)=>(t[1]??0)-(e[1]??0)).slice(0,500);try{localStorage.setItem(H,JSON.stringify(Object.fromEntries(r)))}catch{}}([e]),h(t=>new Set(t).add(e)),c(t=>t.filter(t=>t.did!==e))},[]),A=x?l.find(e=>e.did===x):null;return a.jsxs("div",{className:Y,"aria-label":"Suggested accounts to follow",children:[a.jsx("p",{className:$,children:"Accounts followed by people you follow. New suggestions each time you open."}),l.length>0&&a.jsxs("div",{className:z,children:[a.jsx("span",{className:q,children:"Sort by:"}),a.jsxs("select",{className:K,value:g,onChange:e=>y(e.target.value),"aria-label":"Sort suggestions",children:[a.jsx("option",{value:"count",children:"Most followed by people you follow"}),a.jsx("option",{value:"mutuals",children:"Most followed by mutuals"})]})]}),d&&0===l.length?a.jsx("p",{className:W,children:"Loading…"}):0===l.length?a.jsx("p",{className:G,children:"No suggestions right now. Follow more accounts to see recommendations."}):a.jsx("ul",{className:V,children:j.map(e=>a.jsxs("li",{className:J,children:[a.jsxs("button",{type:"button",className:X,onClick:()=>i(e.handle),"aria-label":`View @${e.handle} profile`,children:[e.avatar?a.jsx("img",{src:e.avatar,alt:"",className:Q,loading:"lazy"}):a.jsx("span",{className:Z,"aria-hidden":!0,children:(e.displayName??e.handle).slice(0,1).toUpperCase()}),a.jsxs("span",{className:ee,children:[a.jsxs("span",{className:te,children:["@",e.handle]}),a.jsx("span",{className:ne,children:"mutuals"===g?1===e.count?"Followed by 1 mutual":`Followed by ${e.count} mutuals`:1===e.count?"Followed by 1 person you follow":`Followed by ${e.count} people you follow`})]})]}),a.jsxs("div",{className:se,children:[a.jsx("button",{type:"button",className:re,onClick:t=>{t.stopPropagation(),k(e)},"aria-label":"Why we recommend this account",title:"Why we recommend this account",children:a.jsx(Me,{})}),a.jsx("button",{type:"button",className:ae,onClick:()=>T(e.did,e.handle),disabled:f===e.did,children:f===e.did?"…":"Follow"}),a.jsx("button",{type:"button",className:ie,onClick:()=>I(e.did),"aria-label":"Not now",title:"Hide this suggestion for a week",children:"×"})]})]},e.did))}),x&&A&&S.createPortal(a.jsx("div",{className:le,role:"dialog","aria-modal":"true","aria-labelledby":"suggestion-detail-title",onClick:()=>w(null),children:a.jsxs("div",{className:ce,onClick:e=>e.stopPropagation(),children:[a.jsxs("div",{className:de,children:[a.jsxs("h3",{id:"suggestion-detail-title",className:ue,children:["Why we recommend @",A.handle]}),a.jsx("button",{type:"button",className:fe,onClick:()=>w(null),"aria-label":"Close",children:"×"})]}),v?a.jsx("p",{className:Ee,children:"Loading…"}):_?a.jsxs("div",{className:pe,children:[a.jsx("p",{className:me,children:_.fromMutuals?1===_.count?"Followed by 1 mutual:":`Followed by ${_.count} mutuals:`:1===_.count?"Followed by 1 person you follow:":`Followed by ${_.count} people you follow:`}),a.jsx("ul",{className:he,children:_.followedBy.map(e=>a.jsx("li",{className:ge,children:a.jsxs("button",{type:"button",className:ye,onClick:()=>{i(e.handle),w(null)},children:[e.avatar?a.jsx("img",{src:e.avatar,alt:"",className:xe,loading:"lazy"}):a.jsx("span",{className:we,"aria-hidden":!0,children:(e.displayName??e.handle).slice(0,1).toUpperCase()}),a.jsxs("span",{className:_e,children:[e.displayName&&a.jsx("span",{className:be,children:e.displayName}),a.jsxs("span",{className:ve,children:["@",e.handle]})]})]})},e.did))})]}):null]})}),document.body)]})}function Me(){return a.jsx("svg",{className:oe,viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":!0,children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}const Ne=N.memo(function(e){const t=N.useRef(null);return function(e,t){const[n,s]=N.useState(!0),r=N.useRef(null);N.useEffect(()=>{const n=e.current;if(n)return r.current=new IntersectionObserver(e=>{for(const t of e)s(t.isIntersecting)},{rootMargin:t?.rootMargin??"400px 0px 400px 0px",threshold:t?.threshold??0,...t}),r.current.observe(n),()=>{r.current&&(r.current.disconnect(),r.current=null)}},[e,t])}(t,{rootMargin:"1200px 0px 1200px 0px",threshold:0}),a.jsx(F,{...e,cardRef:n=>{t.current=n,e.cardRef(n)},onAspectRatio:void 0})}),Se="_wrap_a6pg0_1",ke="_seen_a6pg0_11",Te="_header_a6pg0_15",Ie="_repostIcon_a6pg0_25",Ae="_title_a6pg0_32",Re="_scrollWrap_a6pg0_38",Ce="_track_a6pg0_54",Oe="_tile_a6pg0_60",Fe="_tileImg_a6pg0_86",Pe="_tilePlaceholder_a6pg0_94",Le="_tileHandle_a6pg0_107";function Ue(){return a.jsx("svg",{className:Ie,viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":!0,children:a.jsx("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"})})}function De({items:e,onPostClick:t,cardRef:n,seen:s,"data-post-uri":r}){if(0===e.length)return null;const o=e=>e.reason?.by;return a.jsxs("div",{ref:n,className:`${Se} ${s?ke:""}`,"data-post-uri":r??e[0]?.post?.uri,role:"article","aria-label":`${e.length} reposts`,children:[a.jsxs("div",{className:Te,children:[a.jsx(Ue,{}),a.jsxs("span",{className:Ae,children:[e.length," reposts"]})]}),a.jsx("div",{className:Re,children:a.jsx("div",{className:Ce,children:e.map(e=>{const n=e.post.uri,s=(e=>o(e)?.handle??o(e)?.did??e.post.author?.handle??e.post.author?.did??"")(e),r=i(e.post),l=e.post.author?.avatar,c=r?.url??l;return a.jsxs("button",{type:"button",className:Oe,onClick:()=>t(n,{initialItem:e}),"aria-label":s?`Repost by @${s}, open post`:"Open post",children:[c?a.jsx("img",{src:c,alt:"",className:Fe,loading:"lazy"}):a.jsx("span",{className:Pe,children:(e.post.author?.displayName??s??e.post.author?.did??"?").slice(0,1).toUpperCase()}),s?a.jsxs("span",{className:Le,children:["@",s]}):null]},n)})})})]})}const He=N.memo(function({entry:e,originalIndex:t,isSelected:n,focusedMediaIndex:s,openAddDropdown:r,actionsMenuOpenForIndex:o,nsfwPreference:i,unblurredUris:l,likeOverrides:d,seenUris:u,onMediaRef:f,onActionsMenuOpenChange:p,onMouseEnter:m,onAddClose:h,setUnblurred:g,setLikeOverrides:y,openPostModal:x,cardRef:w}){const _="post"===e.type?e.item.post.uri:e.items[0].post.uri;return a.jsx("div",{ref:w(t),className:L.gridItem,"data-selected":n||void 0,"data-post-uri":_,onMouseEnter:()=>m(t),children:"post"===e.type?a.jsx(Ne,{item:e.item,isSelected:n,focusedMediaIndex:s,onMediaRef:(e,n)=>f(t,e,n),cardRef:()=>{},openAddDropdown:r,onAddClose:h,onActionsMenuOpenChange:e=>p(t,e),cardIndex:t,actionsMenuOpenForIndex:o,onPostClick:(e,t)=>{t?.initialItem&&P(e,t.initialItem),x(e,t?.openReply)},fillCell:!1,nsfwBlurred:"blurred"===i&&c(e.item.post)&&!l.has(e.item.post.uri),onNsfwUnblur:()=>g(e.item.post.uri,!0),likedUriOverride:d[e.item.post.uri],onLikedChange:(e,t)=>y(e,t??null),seen:u.has(e.item.post.uri)}):a.jsx(De,{items:e.items,onPostClick:(e,t)=>{t?.initialItem&&P(e,t.initialItem),x(e)},cardRef:()=>{},seen:u.has(e.items[0].post.uri),"data-post-uri":e.items[0].post.uri})},_)},(e,t)=>{const n="post"===e.entry.type?e.entry.item.post.uri:e.entry.items[0].post.uri,s="post"===t.entry.type?t.entry.item.post.uri:t.entry.items[0].post.uri;return n===s&&(e.isSelected===t.isSelected&&(e.focusedMediaIndex===t.focusedMediaIndex&&(e.openAddDropdown===t.openAddDropdown&&(e.actionsMenuOpenForIndex===t.actionsMenuOpenForIndex&&(e.nsfwPreference===t.nsfwPreference&&(e.likeOverrides[n]===t.likeOverrides[s]&&(e.seenUris.has(n)===t.seenUris.has(s)&&e.unblurredUris.has(n)===t.unblurredUris.has(s))))))))}),Be=N.memo(function({column:e,loadMoreSentinelRef:t,hasCursor:n,keyboardFocusIndex:s,focusTargets:r,focusSetByMouse:o,keyboardAddOpen:i,actionsMenuOpenForIndex:c,nsfwPreference:d,unblurredUris:u,setUnblurred:f,likeOverrides:p,setLikeOverrides:m,seenUris:h,openPostModal:g,cardRef:y,onMediaRef:x,onActionsMenuOpenChange:w,onMouseEnter:_,onAddClose:b}){if(0===e.length)return a.jsx("div",{className:L.gridColumn,children:n&&null!=t&&a.jsx("div",{ref:t,className:L.loadMoreSentinel,"aria-hidden":!0})});const v=r[s]?.cardIndex??-1;return a.jsxs("div",{className:L.gridColumn,children:[e.map(({entry:e,originalIndex:t})=>{const n=v===t,E=!n||o&&l("post"===e.type?e.item.post:e.items[0].post).length>1?void 0:r[s]?.mediaIndex,j="post"===e.type?e.item.post.uri:e.items[0].post.uri;return a.jsx(He,{entry:e,originalIndex:t,isSelected:n,focusedMediaIndex:E,openAddDropdown:n&&i,actionsMenuOpenForIndex:c,nsfwPreference:d,unblurredUris:u,likeOverrides:p,seenUris:h,onMediaRef:x,onActionsMenuOpenChange:w,onMouseEnter:_,onAddClose:b,setUnblurred:f,setLikeOverrides:m,openPostModal:g,cardRef:y},`${j}-${t}`)}),n&&null!=t&&a.jsx("div",{ref:t,className:L.loadMoreSentinel,"aria-hidden":!0})]})});function Ye(e,t){switch(t.type){case"SET_ITEMS":return{...e,items:t.items,cursor:t.cursor,loading:!1,error:null};case"APPEND_ITEMS":return{...e,items:[...e.items,...t.items],cursor:t.cursor,loadingMore:!1,error:null};case"UPDATE_ITEMS":return{...e,items:t.updater(e.items)};case"SET_LOADING":return{...e,loading:t.loading};case"SET_LOADING_MORE":return{...e,loadingMore:t.loadingMore};case"SET_ERROR":return{...e,error:t.error,loading:!1,loadingMore:!1};case"SET_KEYBOARD_FOCUS":return{...e,keyboardFocusIndex:t.index};case"SET_ACTIONS_MENU_OPEN":return{...e,actionsMenuOpenForIndex:t.index};case"MARK_SEEN":{const n=new Set(e.seenUris);if(t.uris.forEach(e=>n.add(e)),n.size>2500){const t=Array.from(n),s=new Set(t.slice(-2e3));return{...e,seenUris:s}}return{...e,seenUris:n}}case"RESET_SEEN_SNAPSHOT":return{...e,seenUrisAtReset:new Set(e.seenUris)};case"CLEAR_SEEN":return{...e,seenUris:new Set,seenUrisAtReset:new Set};default:return e}}function $e(e){const t=new Set;return e.filter(e=>{const n=e?.post?.uri;return!(!n||t.has(n))&&(t.add(n),!0)})}const ze="artsky-seen-posts";function qe(){const e=h.get(ze);return e&&Array.isArray(e)?new Set(e):new Set}const Ke=[{kind:"timeline",label:"Following"},{kind:"custom",label:"What's Hot",uri:"at://did:plc:z72i7hdynmk6r22z27h6tvur/app.bsky.feed.generator/whats-hot"}];function We(e){if("undefined"==typeof window)return()=>{};const t=window.matchMedia("(min-width: 768px)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}function Ge(){return"undefined"!=typeof window&&window.innerWidth>=768}function Ve(e){return"app.bsky.feed.defs#reasonRepost"===e.reason?.$type}function Je(e){const t=e.post.record?.createdAt,n=e.post.indexedAt,s=t??n??"";return s?new Date(s).getTime():0}function Xe(e){const t=[];let n=0,s=[],r=0,o=0;function a(){if(s.length>=4)t.push({type:"carousel",items:[...s],entryIndex:n++});else for(const e of s)t.push({type:"post",item:e,entryIndex:n++});s=[]}for(const i of e){if(!Ve(i)){a(),t.push({type:"post",item:i,entryIndex:n++});continue}const e=Je(i);if(0===s.length){s.push(i),r=e,o=e;continue}const l=Math.min(r,e),c=Math.max(o,e);c-l<=36e5?(s.push(i),r=l,o=c):(a(),s=[i],r=e,o=e)}return a(),t}function Qe(e){if("carousel"===e.type)return 200;const t=i(e.item.post);return t?null!=t.aspectRatio&&t.aspectRatio>0?100+280/t.aspectRatio:320:180}function Ze(e,t){const n=Math.max(e.top,t.top),s=Math.min(e.bottom,t.bottom);return Math.max(0,s-n)}function et(){const t=k(),n=T(),r=I(),o=N.useSyncExternalStore(We,Ge,()=>!1),{openLoginModal:S}=d(),{session:F}=u(),{viewMode:P}=f(),[H,B]=N.useState(Ke[0]),[,Y]=N.useState([]),{likeOverrides:$,setLikeOverride:z}=p(),[q,K]=N.useReducer(Ye,{items:[],cursor:void 0,loading:!0,loadingMore:!1,error:null,keyboardFocusIndex:-1,actionsMenuOpenForIndex:null,seenUris:qe(),seenUrisAtReset:new Set}),W=N.useRef([]),G=N.useRef(!1),V=N.useRef(0),[J,X]=N.useState(!1),{openPostModal:Q,openForumPostModal:Z,isModalOpen:ee}=e(),te=N.useRef([]),ne=N.useRef({}),se=N.useRef([]),re=N.useRef(-1),oe=N.useRef(null),ae=N.useRef(-1),ie=N.useRef(!1),le=N.useRef(!1),[ce,de]=N.useState(!1),[ue,fe]=N.useState(!1),[pe,me]=N.useState(null),he=N.useRef(null),ge=N.useRef(null),ye=N.useRef(t.pathname),xe=N.useRef(q.seenUris);xe.current=q.seenUris;const we=m(),[_e,be]=N.useState(!1),[ve,Ee]=N.useState([]),[Me,Ne]=N.useState(!1),Se=N.useRef(null);N.useEffect(()=>{if(we)return we.setClearSeenHandler(()=>{requestAnimationFrame(()=>{h.remove(ze),xe.current=new Set,K({type:"CLEAR_SEEN"})})}),()=>{we.setClearSeenHandler(null)}},[we]),N.useEffect(()=>{if(we)return we.setHomeClickHandler(()=>{requestAnimationFrame(()=>{window.scrollTo(0,0)})}),()=>{we.setHomeClickHandler(null)}},[we]),N.useEffect(()=>{if(we)return we.setHideSeenOnlyHandler(e=>{requestAnimationFrame(()=>{const t=xe.current.size;K({type:"RESET_SEEN_SNAPSHOT"}),e(0===t?"No read posts in feed":`${t} read posts hidden`)})}),()=>{we.setHideSeenOnlyHandler(null)}},[we]);const ke=N.useCallback(async()=>{if(F)try{const e=(await g()).filter(e=>"feed"===e.type&&e.pinned),t=await Promise.all(e.map(async e=>({kind:"custom",label:await y(e.value).catch(()=>e.value),uri:e.value})));Y(t)}catch{Y([])}else Y([])},[F]);N.useEffect(()=>{ke()},[ke]);const Te=N.useCallback(async()=>{if(F?.did){Ne(!0);try{const e=await x();Ee(e.slice(0,15))}catch{Ee([])}finally{Ne(!1)}}},[F?.did]);N.useEffect(()=>{F?.did?Te():Ee([])},[F?.did,Te]),N.useEffect(()=>{let e;let t="undefined"!=typeof window?window.scrollY:0,n=t;const s=U(()=>{const s=window.scrollY,r=document.body.classList.contains("feed-scrolling"),o=s<n;if(n=s,o)return r&&(document.body.classList.remove("feed-scrolling"),e&&(clearTimeout(e),e=void 0)),void(t=s);r?(e&&clearTimeout(e),e=setTimeout(()=>{document.body.classList.remove("feed-scrolling"),t=window.scrollY,e=void 0},200)):s-t>=48&&(document.body.classList.add("feed-scrolling"),e&&clearTimeout(e),e=setTimeout(()=>{document.body.classList.remove("feed-scrolling"),t=window.scrollY,e=void 0},200))},16);return window.addEventListener("scroll",s,{passive:!0}),()=>{window.removeEventListener("scroll",s),e&&clearTimeout(e),document.body.classList.remove("feed-scrolling")}},[]),N.useEffect(()=>{const e=ye.current!==t.pathname;ye.current=t.pathname,"POP"!==r&&e&&window.scrollTo(0,0)},[t.pathname,r]),N.useEffect(()=>{const e=t.state?.feedSource;e&&(B(e),n(t.pathname,{replace:!0}))},[t.state,t.pathname,n]);const{entries:Ie,totalPercent:Ae}=w(),Re=A(),Ce=N.useRef(null),Oe=N.useRef("unknown"),Fe=N.useRef([]);Fe.current=q.items;const Pe=15e3,Le=N.useCallback(async(e,t)=>{const n=Math.min(3,Math.max(1,"1"===P?1:"2"===P?2:3)),r=n>=2?10*n:30;if(!e&&window.scrollY>100)K({type:"SET_LOADING",loading:!1});else try{if(t?.aborted)return;K(e?{type:"SET_LOADING_MORE",loadingMore:!0}:{type:"SET_LOADING",loading:!0}),K({type:"SET_ERROR",error:null});const n=(e,t)=>Promise.race([e,new Promise((e,n)=>setTimeout(()=>n(new Error("Request timed out. Check your network connection.")),t))]);if(F){if(Ie.length>=2&&Ae>=99){const s=!!e;let o;if(s&&e)try{o=JSON.parse(e)}catch{o=void 0}const{feed:a,cursors:i}=await n(b(Ie.map(e=>({source:e.source,percent:e.percent})),r,o,t),Pe);if(t?.aborted)return;const l=()=>{const e=$e(s?[...Fe.current,...a]:a),t=Object.keys(i).length>0?JSON.stringify(i):void 0;K(s?{type:"APPEND_ITEMS",items:a,cursor:t}:{type:"SET_ITEMS",items:e,cursor:t})};s?N.startTransition(l):l()}else if(1===Ie.length){const t=Ie[0].source;if("timeline"===t.kind){const t=await n(s.getTimeline({limit:r,cursor:e}),Pe),o=()=>{const n=$e(e?[...Fe.current,...t.data.feed]:t.data.feed);K(e?{type:"APPEND_ITEMS",items:t.data.feed,cursor:t.data.cursor}:{type:"SET_ITEMS",items:n,cursor:t.data.cursor})};e?N.startTransition(o):o()}else if(t.uri){const o=await n(s.app.bsky.feed.getFeed({feed:t.uri,limit:r,cursor:e}),Pe),a=()=>{const t=$e(e?[...Fe.current,...o.data.feed]:o.data.feed);K(e?{type:"APPEND_ITEMS",items:o.data.feed,cursor:o.data.cursor}:{type:"SET_ITEMS",items:t,cursor:o.data.cursor})};e?N.startTransition(a):a()}}else if("timeline"===H.kind){const t=await n(s.getTimeline({limit:r,cursor:e}),Pe),o=()=>{const n=$e(e?[...Fe.current,...t.data.feed]:t.data.feed);K(e?{type:"APPEND_ITEMS",items:t.data.feed,cursor:t.data.cursor}:{type:"SET_ITEMS",items:n,cursor:t.data.cursor})};e?N.startTransition(o):o()}else if(H.uri){const t=await n(s.app.bsky.feed.getFeed({feed:H.uri,limit:r,cursor:e}),Pe),o=()=>{const n=$e(e?[...Fe.current,...t.data.feed]:t.data.feed);K(e?{type:"APPEND_ITEMS",items:t.data.feed,cursor:t.data.cursor}:{type:"SET_ITEMS",items:n,cursor:t.data.cursor})};e?N.startTransition(o):o()}}else{const{feed:s,cursor:o}=await n(_(r,e),Pe);if(t?.aborted)return;const a=()=>{const t=$e(e?[...Fe.current,...s]:s);K(e?{type:"APPEND_ITEMS",items:s,cursor:o}:{type:"SET_ITEMS",items:t,cursor:o})};e?N.startTransition(a):a()}}catch(o){const e=o instanceof Error?o.message:"Failed to load feed";K({type:"SET_ERROR",error:e})}finally{K({type:"SET_LOADING",loading:!1}),K({type:"SET_LOADING_MORE",loadingMore:!1})}},[H,F,Ie,Ae]);N.useEffect(()=>{const e=new AbortController;return Le(void 0,e.signal),()=>{e.abort()}},[Le]);G.current=q.loadingMore,N.useEffect(()=>{if(!q.cursor)return;const e=W.current;let t=0,n=0,s=0;const r=Math.min(3,Math.max(1,"1"===P?1:"2"===P?2:3)),o=()=>{clearTimeout(s);const t=Math.max(50,1800-(Date.now()-V.current)+50);s=window.setTimeout(()=>{G.current||(()=>{const t=window.innerHeight+600;for(let n=0;n<r;n++){const s=e[n];if(s&&s.getBoundingClientRect().bottom<t)return!0}return!1})()&&(G.current=!0,V.current=Date.now(),Le(q.cursor))},t)},a=new IntersectionObserver(e=>{for(const s of e){if(!s.isIntersecting||G.current)continue;if(Date.now()-V.current<1800){o();continue}G.current=!0;const e=q.cursor;t=requestAnimationFrame(()=>{t=0,n=window.setTimeout(()=>{n=0,V.current=Date.now(),Le(e)},120)});break}},{rootMargin:"1200px",threshold:0});for(let i=0;i<r;i++){const t=e[i];t&&a.observe(t)}return r>1&&o(),()=>{a.disconnect(),t&&cancelAnimationFrame(t),n&&clearTimeout(n),clearTimeout(s)}},[q.cursor,Le,P]);const{mediaMode:Ue}=v(),{nsfwPreference:De,unblurredUris:He,setUnblurred:Je}=E(),{hideRepostsFromDids:et}=j()??{hideRepostsFromDids:[]},tt=N.useMemo(()=>q.items.filter(e=>"media"!==Ue||i(e.post)).filter(e=>!q.seenUrisAtReset.has(e.post.uri)).filter(e=>"sfw"!==De||!c(e.post)).filter(e=>{if(!Ve(e))return!0;const t=e.reason?.by?.did;return!t||!et.includes(t)}),[q.items,Ue,q.seenUrisAtReset,De,et]),nt=N.useMemo(()=>Xe(tt),[tt]),st=N.useMemo(()=>q.items.filter(e=>"media"!==Ue||i(e.post)).filter(e=>"sfw"!==De||!c(e.post)),[q.items,Ue,De]),rt=0===nt.length&&st.length>0&&!q.cursor,ot=0===nt.length&&null!=q.cursor,at=D(P,150),it=N.useRef([]),lt=N.useRef(0),ct=N.useRef(0);N.useEffect(()=>{it.current=[],lt.current=0,ct.current=0},[H,Ue,De]);const dt=N.useMemo(()=>{at!==ct.current&&(it.current=[],lt.current=0);const e=function(e,t,n,s){const r=Math.min(3,Math.max(1,Math.floor(t)));if(r<1)return[];if(n&&n.length===r&&void 0!==s&&e.length>s){const t=new Map;n.forEach((e,n)=>{e.forEach(({entry:e})=>{const s="post"===e.type?e.item.post.uri:e.items[0]?.post.uri;s&&t.set(s,n)})});const o=Array.from({length:r},()=>[]),a=Array(r).fill(0);for(let n=0;n<s;n++){const s=e[n],i="post"===s.type?s.item.post.uri:s.items[0]?.post.uri;if(i){const e=t.get(i);if(void 0!==e&&e<r){o[e].push({entry:s,originalIndex:n}),a[e]+=Qe(s);continue}}const l=Qe(s);let c=0;for(let e=1;e<r;e++)a[e]<a[c]&&(c=e);o[c].push({entry:s,originalIndex:n}),a[c]+=l}for(let n=s;n<e.length;n++){const t=e[n],s=Qe(t);let i=0;for(let e=1;e<r;e++){const t=a[e]<a[i],n=Math.abs(a[e]-a[i])<2,s=o[e].length<o[i].length;(t||n&&s)&&(i=e)}o[i].push({entry:t,originalIndex:n}),a[i]+=s}return o}const o=Array.from({length:r},()=>[]),a=Array(r).fill(0);for(let i=0;i<e.length;i++){const t=e[i],n=Qe(t),s=o.map(e=>e.length),l=0===s.length?0:Math.min(...s);let c=-1;for(let e=0;e<r;e++){if(o[e].length>l+1)continue;const t=-1===c||a[e]<a[c],n=c>=0&&Math.abs(a[e]-a[c])<2,s=c>=0&&o[e].length<o[c].length;(t||n&&s)&&(c=e)}-1===c&&(c=0),o[c].push({entry:t,originalIndex:i}),a[c]+=n}return o}(nt,at,it.current,lt.current);return it.current=e,lt.current=nt.length,ct.current=at,e},[nt,at]),ut=N.useMemo(()=>{const e=[];return nt.forEach((t,n)=>{if("post"===t.type){const s="text"===Ue?1:Math.max(1,l(t.item.post).length);for(let t=0;t<s;t++)e.push({cardIndex:n,mediaIndex:t})}else e.push({cardIndex:n,mediaIndex:0})}),e},[nt,Ue]),ft=N.useMemo(()=>{const e=[];let t=0;return nt.forEach((n,s)=>{e[s]=t;const r=nt[s],o="post"===r.type?"text"===Ue?1:Math.max(1,l(r.item.post).length):1;t+=o}),e},[nt,Ue]),pt=N.useMemo(()=>{const e=[];return nt.forEach((t,n)=>{const s="post"===t.type?"text"===Ue?1:Math.max(1,l(t.item.post).length):1;e[n]=ft[n]+s-1}),e},[nt,ft,Ue]);se.current=tt,re.current=q.keyboardFocusIndex,oe.current=q.actionsMenuOpenForIndex;const mt=N.useCallback(e=>t=>{te.current[e]=t},[]),ht=N.useCallback((e,t,n)=>{ne.current[e]||(ne.current[e]={}),ne.current[e][t]=n},[]),gt=N.useCallback((e,t)=>{K({type:"SET_ACTIONS_MENU_OPEN",index:t?e:null})},[]),yt=N.useCallback(e=>{o&&le.current&&(le.current=!1,de(!1),fe(!0),K({type:"SET_KEYBOARD_FOCUS",index:ft[e]??0}))},[o,ft]),xt=N.useCallback(()=>{X(!1)},[]);N.useEffect(()=>{const e=q.keyboardFocusIndex;if(e<0)return;if(0===ut.length)return void K({type:"SET_KEYBOARD_FOCUS",index:-1});const t=Math.min(e,ut.length-1);t!==e&&K({type:"SET_KEYBOARD_FOCUS",index:t})},[ut.length,q.keyboardFocusIndex]);const wt=N.useMemo(()=>U(e=>function(e){const t=[...e],n=t.length>2e3?t.slice(-2e3):t;h.set(ze,n)}(e),1e3),[]);N.useEffect(()=>{wt(q.seenUris)},[q.seenUris,wt]),N.useEffect(()=>{const e=new Set;let t=0,n=0;const s=new WeakSet,r=()=>{if(t=0,0===e.size)return;const s=Date.now();if(s-n<400)return void(t=requestAnimationFrame(r));n=s;const o=Array.from(e);e.clear(),N.startTransition(()=>{K({type:"MARK_SEEN",uris:o}),xe.current=new Set([...xe.current,...o])})},o=new IntersectionObserver(n=>{for(const t of n)if(!t.isIntersecting&&t.boundingClientRect.top<0){const n=t.target.getAttribute("data-post-uri");n&&!xe.current.has(n)&&e.add(n)}e.size>0&&!t&&(t=requestAnimationFrame(r))},{threshold:0,rootMargin:"0px"}),a=e=>{e instanceof HTMLElement&&e.hasAttribute("data-post-uri")&&!s.has(e)&&(o.observe(e),s.add(e))},i=Se.current;if(i){i.querySelectorAll("[data-post-uri]").forEach(a);const e=new MutationObserver(e=>{for(const t of e)t.addedNodes.forEach(e=>{if(e instanceof HTMLElement){a(e);e.querySelectorAll("[data-post-uri]").forEach(a)}})});return e.observe(i,{childList:!0,subtree:!0}),()=>{o.disconnect(),e.disconnect(),t&&cancelAnimationFrame(t)}}return()=>{o.disconnect(),t&&cancelAnimationFrame(t)}},[nt.length]),N.useEffect(()=>{const e=()=>{le.current=!0};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]),N.useEffect(()=>{if(!ie.current)return;if(ie.current=!1,q.keyboardFocusIndex===ae.current)return;ae.current=q.keyboardFocusIndex;const e=ut[q.keyboardFocusIndex],t=requestAnimationFrame(()=>{const t=e?.cardIndex??q.keyboardFocusIndex,n=e?.mediaIndex??0,s=ne.current[t]?.[n],r=s??te.current[t];r&&r.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})});return()=>cancelAnimationFrame(t)},[q.keyboardFocusIndex,ut]),N.useEffect(()=>{const e=e=>{const n=/[?&](post|profile|tag|forumPost|artboard)=/.test(t.search);if(ee||n)return;const r=e.target;if("INPUT"===r.tagName||"TEXTAREA"===r.tagName||"SELECT"===r.tagName||r.isContentEditable)return void("Escape"===e.key&&(e.preventDefault(),r.blur()));if(e.ctrlKey||e.metaKey)return;const o=re.current;if(0===nt.length||0===ut.length)return;fe(!1);const a=ut[o],i=a?.cardIndex??0,l=nt[i],c="post"===l?.type?l.item:"carousel"===l?.type?l.items[0]:null,d=e.key.toLowerCase(),u=document.activeElement?.closest?.('[role="menu"]'),f=q.actionsMenuOpenForIndex===i;if((u||f)&&("w"===d||"s"===d||"e"===d||"enter"===d||"q"===d||"escape"===d))return;if(e.repeat&&("a"===d||"d"===d||"ArrowLeft"===e.key||"ArrowRight"===e.key))return;if(pe)return"escape"===d?(e.preventDefault(),void me(null)):void 0;if("w"!==d&&"s"!==d&&"a"!==d&&"d"!==d&&"e"!==d&&"enter"!==d&&"r"!==d&&"f"!==d&&"c"!==d&&"h"!==d&&"b"!==d&&"m"!==d&&"`"!==d&&"4"!==d&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||e.preventDefault(),"b"===d)return void(c?.post?.author&&F?.did!==c.post.author.did&&(me({did:c.post.author.did,handle:c.post.author.handle??c.post.author.did,avatar:c.post.author.avatar}),requestAnimationFrame(()=>he.current?.focus())));const p=o<0,m=at>=2?dt:null,h=e=>te.current[e]?.getBoundingClientRect();if("w"===d||"ArrowUp"===e.key){le.current=!1,de(!0),ie.current=!0;const e=o===ft[i],t=p?pt[nt.length-1]??ut.length-1:e?(()=>{const e=at>=2&&m?function(e,t){for(let n=0;n<e.length;n++){const s=e[n].findIndex(e=>e.originalIndex===t);if(s>0)return e[n][s-1].originalIndex;if(0===s)return t}return t}(m,i):Math.max(0,i-1);return pt[e]??ft[e]??0})():Math.max(0,o-1);return void K({type:"SET_KEYBOARD_FOCUS",index:t})}if("s"===d||"ArrowDown"===e.key){le.current=!1,de(!0),ie.current=!0;const e=o===pt[i],t=p?0:e?(()=>{const e=at>=2&&m?function(e,t){for(let n=0;n<e.length;n++){const s=e[n].findIndex(e=>e.originalIndex===t);if(s>=0&&s<e[n].length-1)return e[n][s+1].originalIndex;if(s>=0)return t}return t}(m,i):Math.min(nt.length-1,i+1);return ft[e]??o})():Math.min(ut.length-1,o+1);return void K({type:"SET_KEYBOARD_FOCUS",index:t})}if("a"===d||"ArrowLeft"===e.key){le.current=!1,de(!0),ie.current=!0;const e=p?0:at>=2&&m?function(e,t,n){for(let s=0;s<e.length;s++){if(e[s].findIndex(e=>e.originalIndex===t)<0)continue;if(0===s)return t;const r=e[s-1],o=n(t);if(!o)return t;let a=t,i=-1;for(const{originalIndex:e}of r){const t=n(e);if(!t)continue;const s=Ze(o,t);s>0&&s>i&&(i=s,a=e)}return a}return t}(m,i,h):i,t=p?0:e!==i?pt[e]??o:o;return t!==o&&K({type:"SET_ACTIONS_MENU_OPEN",index:null}),void K({type:"SET_KEYBOARD_FOCUS",index:t})}if("d"===d||"ArrowRight"===e.key){le.current=!1,de(!0),ie.current=!0;const e=p?0:at>=2&&m?function(e,t,n){for(let s=0;s<e.length;s++){if(e[s].findIndex(e=>e.originalIndex===t)<0)continue;if(s===e.length-1)return t;const r=e[s+1],o=n(t);if(!o)return t;let a=t,i=-1;for(const{originalIndex:e}of r){const t=n(e);if(!t)continue;const s=Ze(o,t);s>0&&s>i&&(i=s,a=e)}return a}return t}(m,i,h):i,t=p?0:e!==i?pt[e]??o:o;return t!==o&&K({type:"SET_ACTIONS_MENU_OPEN",index:null}),void K({type:"SET_KEYBOARD_FOCUS",index:t})}if(("m"===d||"`"===d)&&o>=0)K(f?{type:"SET_ACTIONS_MENU_OPEN",index:null}:{type:"SET_ACTIONS_MENU_OPEN",index:i});else if("e"!==d&&"enter"!==d)if("r"!==d){if("f"===d){const e=c;if(!e?.post?.uri||!e?.post?.cid)return;const t=e.post.uri,n=t in $?$[t]??void 0:e.post.viewer?.like;return void(n?s.deleteLike(n).then(()=>{z(t,null)}).catch(()=>{}):s.like(t,e.post.cid).then(e=>{z(t,e.uri)}).catch(()=>{}))}if("c"!==d){if("4"===d){const e=c?.post?.author,t=c?.post?.uri;if(e&&F?.did&&F.did!==e.did&&t){const n=e.viewer?.following;n?s.deleteFollow(n).then(()=>{K({type:"UPDATE_ITEMS",updater:e=>e.map(e=>{if(e.post.uri!==t)return e;const n=e.post,s=n.author;return{...e,post:{...n,author:{...s,viewer:{...s.viewer,following:void 0}}}}})})}).catch(()=>{}):s.follow(e.did).then(e=>{K({type:"UPDATE_ITEMS",updater:n=>n.map(n=>{if(n.post.uri!==t)return n;const s=n.post,r=s.author;return{...n,post:{...s,author:{...r,viewer:{...r.viewer,following:e.uri}}}}})})}).catch(()=>{})}}}else X(!0)}else c&&Q(c.post.uri,!0);else c&&Q(c.post.uri)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t.search,at,ee,Q,pe,F,$,q.actionsMenuOpenForIndex,ut,ft,pt]),N.useEffect(()=>{pe&&he.current?.focus()},[pe]);const _t=N.useRef(null),bt=N.useContext(R),vt=O({scrollRef:{current:null},touchTargetRef:bt?.wrapperRef??_t,onRefresh:async()=>{await Le(),requestAnimationFrame(()=>{window.scrollTo(0,0)})},enabled:o,maxTouchStartY:130}),Et=!!Re&&1===Ie.length&&Re.feedSources.length>1,jt=N.useCallback(e=>{vt.onTouchStart(e),Et&&1===e.touches.length&&(Ce.current={x:e.touches[0].clientX,y:e.touches[0].clientY},Oe.current="unknown")},[Et,vt]),Mt=N.useCallback(e=>{if(Et&&Ce.current&&1===e.touches.length){if("unknown"===Oe.current){const t=e.touches[0].clientX-Ce.current.x,n=e.touches[0].clientY-Ce.current.y;(Math.abs(t)>20||Math.abs(n)>20)&&(Oe.current=Math.abs(t)>2*Math.abs(n)?"swipe":"pull")}"pull"!==Oe.current&&"unknown"!==Oe.current||vt.onTouchMove(e)}else vt.onTouchMove(e)},[Et,vt]),Nt=N.useCallback(e=>{if(Et&&Re&&Ce.current&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX-Ce.current.x,n=e.changedTouches[0].clientY-Ce.current.y;if("swipe"===Oe.current&&Math.abs(t)>80&&Math.abs(t)>2*Math.abs(n)){const e=Re.feedSources,n=Ie[0].source,s=e.findIndex(e=>{return s=n,((t=e).uri??t.label)===(s.uri??s.label);var t,s});if(s>=0){const n=t<0?(s+1)%e.length:(s-1+e.length)%e.length;Re.setSingleFeed(e[n])}}Ce.current=null,Oe.current="unknown"}vt.onTouchEnd(e)},[Et,Re,Ie,vt]);N.useEffect(()=>{const e=bt?.setHandlers;if(e)return e({onTouchStart:jt,onTouchMove:Mt,onTouchEnd:Nt}),()=>{e(null)}},[bt?.setHandlers,jt,Mt,Nt]);const St=!!bt?.wrapperRef;return a.jsx(C,{title:"Feed",showNav:!0,children:a.jsxs(a.Fragment,{children:[a.jsxs("div",{ref:_t,className:L.wrap,onTouchStart:St?void 0:jt,onTouchMove:St?void 0:Mt,onTouchEnd:St?void 0:Nt,children:[a.jsx("div",{className:`${L.pullRefreshHeader} ${vt.pullDistance>0||vt.isRefreshing?L.pullRefreshHeaderActive:""}`,"aria-hidden":0===vt.pullDistance&&!vt.isRefreshing,"aria-live":"polite","aria-label":vt.isRefreshing?"Refreshing":void 0,children:(vt.pullDistance>0||vt.isRefreshing)&&a.jsx("div",{className:L.pullRefreshSpinner})}),a.jsxs("div",{className:L.pullRefreshContent,style:{transform:`translateY(${vt.pullDistance}px)`},children:[F&&a.jsxs("div",{className:L.suggestedFollowsSection,children:[a.jsx("div",{className:L.suggestedFollowsSectionInner,children:a.jsx("button",{type:"button",className:L.suggestedFollowsToggle,onClick:()=>be(e=>!e),"aria-expanded":_e,"aria-label":_e?"Hide suggestions":"Discover accounts to follow",children:_e?"Hide suggestions":"Discover accounts"})}),_e&&a.jsx(je,{})]}),F&&a.jsxs("section",{className:L.blogPostcardsSection,"aria-label":"Blogs from people you follow",children:[a.jsx("h3",{className:L.blogPostcardsTitle,children:"Blogs from people you follow"}),Me?a.jsx("p",{className:L.blogPostcardsLoading,children:"Loading…"}):0===ve.length?null:a.jsx("div",{className:L.blogPostcardsScroll,children:ve.map(e=>{const t=e.authorHandle??e.did,n=e.title||e.path||"Untitled",s=(e.body??"").replace(/\s+/g," ").trim().slice(0,80);return a.jsxs("button",{type:"button",className:L.blogPostcard,onClick:()=>Z(e.uri),children:[a.jsx("span",{className:L.blogPostcardTitle,children:n}),a.jsxs("span",{className:L.blogPostcardMeta,children:["@",t]}),s&&a.jsxs("span",{className:L.blogPostcardPreview,children:[s,s.length>=80?"…":""]})]},e.uri)})})]}),a.jsxs("div",{className:L.feedContentTransition,children:[q.error&&a.jsx("p",{className:L.error,children:q.error}),q.loading?a.jsx("div",{className:L.loading,children:"Loading…"}):0===nt.length?a.jsx("div",{className:L.empty,children:ot?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:L.emptyLoadMoreText,children:st.length>0?"You've seen everything visible from this batch. There may be more from your other feeds.":"No posts in this batch."}),a.jsx("button",{type:"button",className:L.loadMoreBtn,onClick:()=>q.cursor&&!q.loadingMore&&Le(q.cursor),disabled:q.loadingMore,children:q.loadingMore?"Loading…":"Load more"})]}):rt?a.jsxs(a.Fragment,{children:["You've read all the posts in this feed.",a.jsx("br",{}),"New posts will appear as they're posted."]}):"media"===Ue?"No posts with images or videos in this feed.":"No posts in this feed."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:Se,className:`${L.gridColumns} ${L[`gridView${P}`]}`,"data-feed-cards":!0,"data-view-mode":P,"data-keyboard-nav":ce||void 0,children:dt.map((e,t)=>a.jsx(Be,{column:e,colIndex:t,loadMoreSentinelRef:q.cursor?e=>{W.current[t]=e}:void 0,hasCursor:!!q.cursor,keyboardFocusIndex:q.keyboardFocusIndex,focusTargets:ut,firstFocusIndexForCard:ft,focusSetByMouse:ue,keyboardAddOpen:J,actionsMenuOpenForIndex:q.actionsMenuOpenForIndex,nsfwPreference:De,unblurredUris:He,setUnblurred:Je,likeOverrides:$,setLikeOverrides:z,seenUris:q.seenUris,openPostModal:Q,cardRef:mt,onMediaRef:ht,onActionsMenuOpenChange:gt,onMouseEnter:yt,onAddClose:xt},t))}),F&&a.jsxs("div",{className:L.loadMoreRow,children:[q.loadingMore&&a.jsx("p",{className:L.loadingMore,role:"status",children:"Loading more…"}),a.jsx("button",{type:"button",className:L.loadMoreBtn,onClick:()=>q.cursor&&!q.loadingMore&&Le(q.cursor),disabled:q.loadingMore||!q.cursor,children:q.cursor?"Load more":"No more posts"})]})]})]},1===Ie.length?Ie[0].source.uri??Ie[0].source.label:"mixed"),!F&&a.jsxs("div",{className:L.feedLoginHint,children:[a.jsx("div",{className:L.feedLoginHintBtnRow,children:a.jsx("button",{type:"button",className:L.feedLoginHintBtn,onClick:()=>S(),children:"Log in"})}),a.jsxs("p",{className:L.feedLoginHintText,children:["Or"," ",a.jsx("button",{type:"button",className:L.feedLoginHintLink,onClick:()=>S("create"),children:"create an account"})," to see your own feeds."]})]})]})]}),pe&&a.jsx("div",{className:L.blockOverlay,role:"dialog","aria-modal":"true","aria-labelledby":"block-dialog-title",onKeyDown:e=>"Escape"===e.key&&me(null),onClick:()=>me(null),children:a.jsxs("div",{className:L.blockDialog,onClick:e=>e.stopPropagation(),children:[a.jsx("h2",{id:"block-dialog-title",className:L.blockTitle,children:"Block user?"}),a.jsxs("div",{className:L.blockUser,children:[pe.avatar?a.jsx("img",{src:pe.avatar,alt:"",className:L.blockAvatar,loading:"lazy"}):a.jsx("div",{className:L.blockAvatarPlaceholder}),a.jsxs("span",{className:L.blockHandle,children:["@",pe.handle]})]}),a.jsxs("div",{className:L.blockActions,children:[a.jsx("button",{ref:he,type:"button",className:L.blockCancelBtn,onClick:()=>me(null),children:"Cancel"}),a.jsx("button",{ref:ge,type:"button",className:L.blockConfirmBtn,onClick:async()=>{if(pe)try{await M(pe.did),me(null)}catch(e){}},children:"Block"})]})]})})]})})}export{Xe as buildDisplayEntries,et as default};
